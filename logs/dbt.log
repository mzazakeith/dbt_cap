[0m17:20:39.736350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d7c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfaa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfb8d0>]}


============================== 17:20:39.755371 | 53a7bb11-ec64-438b-90e2-cdc8c7a2083a ==============================
[0m17:20:39.755371 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:20:39.755735 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'printer_width': '80', 'introspect': 'True', 'empty': 'None', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error': 'None', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:20:39.789769 [info ] [MainThread]: dbt version: 1.10.15
[0m17:20:39.790069 [info ] [MainThread]: python version: 3.11.6
[0m17:20:39.790236 [info ] [MainThread]: python path: /Users/mzaza/Downloads/main_task/.venv/bin/python
[0m17:20:39.790386 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m17:20:39.819578 [info ] [MainThread]: Using profiles dir at /Users/mzaza/Downloads/main_task
[0m17:20:39.819873 [info ] [MainThread]: Using profiles.yml file at /Users/mzaza/Downloads/main_task/profiles.yml
[0m17:20:39.820030 [info ] [MainThread]: Using dbt_project.yml file at /Users/mzaza/Downloads/main_task/dbt_project.yml
[0m17:20:39.820419 [info ] [MainThread]: adapter type: postgres
[0m17:20:39.820558 [info ] [MainThread]: adapter version: 1.9.1
[0m17:20:39.868821 [info ] [MainThread]: Configuration:
[0m17:20:39.869143 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:20:39.869299 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:20:39.869438 [info ] [MainThread]: Required dependencies:
[0m17:20:39.869622 [debug] [MainThread]: Executing "git --help"
[0m17:20:39.887100 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:20:39.887735 [debug] [MainThread]: STDERR: "b''"
[0m17:20:39.887937 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:20:39.888126 [info ] [MainThread]: Connection:
[0m17:20:39.888310 [info ] [MainThread]:   host: localhost
[0m17:20:39.888444 [info ] [MainThread]:   port: 5432
[0m17:20:39.888570 [info ] [MainThread]:   user: postgres
[0m17:20:39.888694 [info ] [MainThread]:   database: chw_analytics
[0m17:20:39.888814 [info ] [MainThread]:   schema: marts
[0m17:20:39.888935 [info ] [MainThread]:   connect_timeout: 10
[0m17:20:39.889056 [info ] [MainThread]:   role: None
[0m17:20:39.889178 [info ] [MainThread]:   search_path: None
[0m17:20:39.889299 [info ] [MainThread]:   keepalives_idle: 0
[0m17:20:39.889417 [info ] [MainThread]:   sslmode: None
[0m17:20:39.889537 [info ] [MainThread]:   sslcert: None
[0m17:20:39.889656 [info ] [MainThread]:   sslkey: None
[0m17:20:39.889778 [info ] [MainThread]:   sslrootcert: None
[0m17:20:39.889901 [info ] [MainThread]:   application_name: dbt
[0m17:20:39.890021 [info ] [MainThread]:   retries: 1
[0m17:20:39.890328 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:20:40.570661 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:20:40.609105 [debug] [MainThread]: Using postgres connection "debug"
[0m17:20:40.609340 [debug] [MainThread]: On debug: select 1 as id
[0m17:20:40.609489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:40.630903 [debug] [MainThread]: SQL status: SELECT 1 in 0.021 seconds
[0m17:20:40.631470 [debug] [MainThread]: On debug: Close
[0m17:20:40.631658 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:20:40.631853 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:20:41.115849 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.4220535, "process_in_blocks": "0", "process_kernel_time": 0.227867, "process_mem_max_rss": "149192704", "process_out_blocks": "0", "process_user_time": 0.861257}
[0m17:20:41.116955 [debug] [MainThread]: Command `dbt debug` succeeded at 17:20:41.116789 after 1.42 seconds
[0m17:20:41.117446 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:20:41.117896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b26550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e0fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105325190>]}
[0m17:20:41.118398 [debug] [MainThread]: Flushing usage events
[0m17:20:42.422495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:41.933253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105273fd0>]}


============================== 17:21:41.935625 | cffac9eb-377b-4dc0-a7e2-fa37fa1952e3 ==============================
[0m17:21:41.935625 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:21:41.935945 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'indirect_selection': 'eager', 'invocation_command': 'dbt list', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'None', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'quiet': 'False', 'introspect': 'True', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m17:21:42.015638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cffac9eb-377b-4dc0-a7e2-fa37fa1952e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534a8d0>]}
[0m17:21:42.041896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cffac9eb-377b-4dc0-a7e2-fa37fa1952e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029cacd0>]}
[0m17:21:42.042379 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:21:42.100906 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:21:42.101408 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:21:42.101625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cffac9eb-377b-4dc0-a7e2-fa37fa1952e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574b610>]}
[0m17:21:42.500214 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.chw_analytics.chw_activity_monthly' (models/starter_code/chw_activity_monthly.sql) depends on a node named 'fct_chv_activity' which was not found
[0m17:21:42.501852 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 0.60370827, "process_in_blocks": "0", "process_kernel_time": 0.158474, "process_mem_max_rss": "128958464", "process_out_blocks": "0", "process_user_time": 1.170238}
[0m17:21:42.502107 [debug] [MainThread]: Command `dbt list` failed at 17:21:42.502062 after 0.60 seconds
[0m17:21:42.502304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b98c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100838fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f3650>]}
[0m17:21:42.502496 [debug] [MainThread]: Flushing usage events
[0m17:21:43.934895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:06.736034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c54d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a2bfd0>]}


============================== 17:23:06.738586 | c9a9740f-6c38-423b-bca6-c34513feea6d ==============================
[0m17:23:06.738586 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:23:06.738945 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'partial_parse': 'True', 'version_check': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'fail_fast': 'False', 'empty': 'None', 'log_format': 'default', 'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt list', 'indirect_selection': 'eager', 'printer_width': '80', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/mzaza/Downloads/main_task'}
[0m17:23:06.814280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9a9740f-6c38-423b-bca6-c34513feea6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a8c590>]}
[0m17:23:06.840790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9a9740f-6c38-423b-bca6-c34513feea6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107104ad0>]}
[0m17:23:06.841301 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:23:06.899002 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:23:06.899504 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:23:06.899730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9a9740f-6c38-423b-bca6-c34513feea6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109afe4d0>]}
[0m17:23:07.429412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9a9740f-6c38-423b-bca6-c34513feea6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5bf050>]}
[0m17:23:07.468033 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:23:07.469300 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:23:07.480620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9a9740f-6c38-423b-bca6-c34513feea6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6a7410>]}
[0m17:23:07.481173 [info ] [MainThread]: chw_analytics.starter_code.chw_activity_monthly
[0m17:23:07.481375 [info ] [MainThread]: chw_analytics.macros.month_assignment
[0m17:23:07.481519 [info ] [MainThread]: source:chw_analytics.fct_chv_activity.fct_chv_activity
[0m17:23:07.481658 [info ] [MainThread]: chw_analytics.starter_code.source_not_null_fct_chv_activity_fct_chv_activity_activity_id
[0m17:23:07.481796 [info ] [MainThread]: chw_analytics.starter_code.source_unique_fct_chv_activity_fct_chv_activity_activity_id
[0m17:23:07.483498 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.7822532, "process_in_blocks": "0", "process_kernel_time": 0.157797, "process_mem_max_rss": "135708672", "process_out_blocks": "0", "process_user_time": 1.345327}
[0m17:23:07.483809 [debug] [MainThread]: Command `dbt list` succeeded at 17:23:07.483758 after 0.78 seconds
[0m17:23:07.484038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501d110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099bb690>]}
[0m17:23:07.484242 [debug] [MainThread]: Flushing usage events
[0m17:23:09.029638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:14.723864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113875e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138cee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138fd1d0>]}


============================== 17:24:14.726326 | 2d71ec3d-8b11-4873-a566-46b66c4585d2 ==============================
[0m17:24:14.726326 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:24:14.726645 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt list', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'printer_width': '80', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'introspect': 'True', 'empty': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/mzaza/Downloads/main_task/logs'}
[0m17:24:14.802681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d71ec3d-8b11-4873-a566-46b66c4585d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138cf750>]}
[0m17:24:14.829112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d71ec3d-8b11-4873-a566-46b66c4585d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d64d0>]}
[0m17:24:14.829624 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:24:14.887712 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:24:14.943434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:14.943687 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:14.965566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d71ec3d-8b11-4873-a566-46b66c4585d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114941790>]}
[0m17:24:15.007204 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:24:15.008288 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:24:15.014098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d71ec3d-8b11-4873-a566-46b66c4585d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114bef90>]}
[0m17:24:15.014587 [info ] [MainThread]: chw_analytics.starter_code.chw_activity_monthly
[0m17:24:15.014780 [info ] [MainThread]: chw_analytics.macros.month_assignment
[0m17:24:15.014918 [info ] [MainThread]: source:chw_analytics.fct_chv_activity.fct_chv_activity
[0m17:24:15.015048 [info ] [MainThread]: chw_analytics.starter_code.source_not_null_fct_chv_activity_fct_chv_activity_activity_id
[0m17:24:15.015181 [info ] [MainThread]: chw_analytics.starter_code.source_unique_fct_chv_activity_fct_chv_activity_activity_id
[0m17:24:15.016734 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.32889834, "process_in_blocks": "0", "process_kernel_time": 0.159531, "process_mem_max_rss": "130695168", "process_out_blocks": "0", "process_user_time": 0.906394}
[0m17:24:15.017011 [debug] [MainThread]: Command `dbt list` succeeded at 17:24:15.016963 after 0.33 seconds
[0m17:24:15.017216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138fec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138fc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10502d110>]}
[0m17:24:15.017409 [debug] [MainThread]: Flushing usage events
[0m17:24:16.509982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:28.737969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b608d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc6e10>]}


============================== 17:25:28.740663 | b5765a74-5c3d-46b4-b510-d49f9db65b14 ==============================
[0m17:25:28.740663 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:25:28.740999 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select chw_activity_monthly', 'target_path': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'partial_parse': 'True', 'empty': 'False'}
[0m17:25:28.818736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5765a74-5c3d-46b4-b510-d49f9db65b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108240450>]}
[0m17:25:28.845839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5765a74-5c3d-46b4-b510-d49f9db65b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f8a90>]}
[0m17:25:28.846401 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:25:28.907092 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:25:28.971498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:28.971792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:28.993857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5765a74-5c3d-46b4-b510-d49f9db65b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf7f50>]}
[0m17:25:29.034150 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:25:29.035393 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:25:29.051746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5765a74-5c3d-46b4-b510-d49f9db65b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108631bd0>]}
[0m17:25:29.052060 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 460 macros
[0m17:25:29.052250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5765a74-5c3d-46b4-b510-d49f9db65b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108414b50>]}
[0m17:25:29.052981 [info ] [MainThread]: 
[0m17:25:29.053179 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:25:29.053330 [info ] [MainThread]: 
[0m17:25:29.053611 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:25:29.054057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics'
[0m17:25:29.083867 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics"
[0m17:25:29.084126 [debug] [ThreadPool]: On list_chw_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:25:29.084292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:29.109416 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.025 seconds
[0m17:25:29.110369 [debug] [ThreadPool]: On list_chw_analytics: Close
[0m17:25:29.110775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_chw_analytics, now create_chw_analytics_marts_metrics)
[0m17:25:29.111006 [debug] [ThreadPool]: Creating schema "database: "chw_analytics"
schema: "marts_metrics"
"
[0m17:25:29.113820 [debug] [ThreadPool]: Using postgres connection "create_chw_analytics_marts_metrics"
[0m17:25:29.114003 [debug] [ThreadPool]: On create_chw_analytics_marts_metrics: BEGIN
[0m17:25:29.114142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:29.125735 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m17:25:29.125906 [debug] [ThreadPool]: Using postgres connection "create_chw_analytics_marts_metrics"
[0m17:25:29.126061 [debug] [ThreadPool]: On create_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "create_chw_analytics_marts_metrics"} */
create schema if not exists "marts_metrics"
[0m17:25:29.126845 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m17:25:29.127291 [debug] [ThreadPool]: On create_chw_analytics_marts_metrics: COMMIT
[0m17:25:29.127442 [debug] [ThreadPool]: Using postgres connection "create_chw_analytics_marts_metrics"
[0m17:25:29.127571 [debug] [ThreadPool]: On create_chw_analytics_marts_metrics: COMMIT
[0m17:25:29.128340 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m17:25:29.128482 [debug] [ThreadPool]: On create_chw_analytics_marts_metrics: Close
[0m17:25:29.129023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_chw_analytics_marts_metrics, now list_chw_analytics_marts_metrics)
[0m17:25:29.131785 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:25:29.131965 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m17:25:29.132154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:29.132346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts'
[0m17:25:29.133413 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:25:29.133568 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m17:25:29.133695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:29.144030 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:25:29.144249 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m17:25:29.144425 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:25:29.144591 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:25:29.144763 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m17:25:29.144953 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m17:25:29.153122 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:25:29.153348 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m17:25:29.154104 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m17:25:29.154689 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m17:25:29.155000 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m17:25:29.155138 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m17:25:29.157743 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:29.157927 [debug] [MainThread]: On master: BEGIN
[0m17:25:29.158064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:29.170708 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:25:29.170989 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:29.171201 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:25:29.177613 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m17:25:29.178357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5765a74-5c3d-46b4-b510-d49f9db65b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b60ed0>]}
[0m17:25:29.178694 [debug] [MainThread]: On master: ROLLBACK
[0m17:25:29.179027 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:29.179199 [debug] [MainThread]: On master: BEGIN
[0m17:25:29.179578 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:25:29.179730 [debug] [MainThread]: On master: COMMIT
[0m17:25:29.179867 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:29.179999 [debug] [MainThread]: On master: COMMIT
[0m17:25:29.180259 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:25:29.180409 [debug] [MainThread]: On master: Close
[0m17:25:29.182142 [debug] [Thread-1 (]: Began running node model.chw_analytics.chw_activity_monthly
[0m17:25:29.182482 [info ] [Thread-1 (]: 1 of 1 START sql incremental model marts_metrics.chw_activity_monthly .......... [RUN]
[0m17:25:29.182729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts_metrics, now model.chw_analytics.chw_activity_monthly)
[0m17:25:29.182924 [debug] [Thread-1 (]: Began compiling node model.chw_analytics.chw_activity_monthly
[0m17:25:29.189418 [debug] [Thread-1 (]: Writing injected SQL for node "model.chw_analytics.chw_activity_monthly"
[0m17:25:29.190075 [debug] [Thread-1 (]: Began executing node model.chw_analytics.chw_activity_monthly
[0m17:25:29.249298 [debug] [Thread-1 (]: Writing runtime sql for node "model.chw_analytics.chw_activity_monthly"
[0m17:25:29.250147 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:25:29.250352 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: BEGIN
[0m17:25:29.250530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:29.259326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:25:29.259626 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:25:29.259924 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      
  
    

  create  table "chw_analytics"."marts_metrics"."chw_activity_monthly"
  
  
    as
  
  (
    /*
Model: chw_activity_monthly
Description: Monthly aggregation of CHW activities for dashboard performance metrics

TODO: Complete this dbt model to aggregate CHW activities by month

Instructions:
1. Add the dbt config block (materialization, unique_key, incremental_strategy)
2. Filter out invalid records (NULL chv_id, NULL activity_date, deleted records)
3. Use the month_assignment macro to calculate report_month
4. Aggregate metrics: total_activities, unique_households_visited, unique_patients_served, pregnancy_visits, child_assessments, family_planning_visits
5. GROUP BY chv_id and report_month
6. Add incremental logic 
*/

-- ============================================
-- dbt Configuration
-- ============================================



-- ============================================
-- Main Query
-- ============================================

with source_data as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        is_deleted,
        created_at,
        updated_at
    from "chw_analytics"."marts"."fct_chv_activity"

    where 1=1
        -- Filter out invalid records as per business requirements
        and chv_id is not null
        and activity_date is not null  
        and is_deleted = false


),

with_report_month as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        -- Use the month_assignment macro to calculate report_month
        


    case 
        -- Activities on/after 26th go to next month
        when extract(day from activity_date) >= 26 then
            case 
                -- If it's December, go to January of next year
                when extract(month from activity_date) = 12 then
                    make_date(extract(year from activity_date) + 1, 1, 1)
                -- Otherwise, go to next month
                else
                    date_trunc('month', activity_date + interval '1 month')
            end
        -- Activities before 26th stay in current month  
        else
            date_trunc('month', activity_date)
    end
    

 as report_month

    from source_data

),

aggregated as (

    select
        chv_id,
        report_month,
        -- Calculate all required metrics
        count(*) as total_activities,
        count(distinct household_id) as unique_households_visited,
        count(distinct patient_id) as unique_patients_served,
        count(case when activity_type = 'pregnancy_visit' then 1 end) as pregnancy_visits,
        count(case when activity_type = 'child_assessment' then 1 end) as child_assessments,
        count(case when activity_type = 'family_planning' then 1 end) as family_planning_visits

    from with_report_month
    group by chv_id, report_month

)

-- ============================================
-- Incremental Logic
-- ============================================


    select * from aggregated


  );
  
  
[0m17:25:29.262273 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function make_date(numeric, integer, integer) does not exist
LINE 80:                     make_date(extract(year from activity_dat...
                             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m17:25:29.262476 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: ROLLBACK
[0m17:25:29.262959 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: Close
[0m17:25:29.267819 [debug] [Thread-1 (]: Database Error in model chw_activity_monthly (models/starter_code/chw_activity_monthly.sql)
  function make_date(numeric, integer, integer) does not exist
  LINE 80:                     make_date(extract(year from activity_dat...
                               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/chw_analytics/models/starter_code/chw_activity_monthly.sql
[0m17:25:29.269322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5765a74-5c3d-46b4-b510-d49f9db65b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549f3d0>]}
[0m17:25:29.269711 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model marts_metrics.chw_activity_monthly . [[31mERROR[0m in 0.09s]
[0m17:25:29.270010 [debug] [Thread-1 (]: Finished running node model.chw_analytics.chw_activity_monthly
[0m17:25:29.270262 [debug] [Thread-7 (]: Marking all children of 'model.chw_analytics.chw_activity_monthly' to be skipped because of status 'error'.  Reason: Database Error in model chw_activity_monthly (models/starter_code/chw_activity_monthly.sql)
  function make_date(numeric, integer, integer) does not exist
  LINE 80:                     make_date(extract(year from activity_dat...
                               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/chw_analytics/models/starter_code/chw_activity_monthly.sql.
[0m17:25:29.271182 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:29.271378 [debug] [MainThread]: On master: BEGIN
[0m17:25:29.271529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:29.281228 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:25:29.281497 [debug] [MainThread]: On master: COMMIT
[0m17:25:29.281656 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:29.281798 [debug] [MainThread]: On master: COMMIT
[0m17:25:29.282130 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:25:29.282285 [debug] [MainThread]: On master: Close
[0m17:25:29.282499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:29.282644 [debug] [MainThread]: Connection 'model.chw_analytics.chw_activity_monthly' was properly closed.
[0m17:25:29.282786 [debug] [MainThread]: Connection 'list_chw_analytics_marts' was properly closed.
[0m17:25:29.282943 [info ] [MainThread]: 
[0m17:25:29.283109 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m17:25:29.283435 [debug] [MainThread]: Command end result
[0m17:25:29.294319 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:25:29.295510 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:25:29.298539 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m17:25:29.298717 [info ] [MainThread]: 
[0m17:25:29.298924 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:25:29.299093 [info ] [MainThread]: 
[0m17:25:29.299299 [error] [MainThread]: [31mFailure in model chw_activity_monthly (models/starter_code/chw_activity_monthly.sql)[0m
[0m17:25:29.299495 [error] [MainThread]:   Database Error in model chw_activity_monthly (models/starter_code/chw_activity_monthly.sql)
  function make_date(numeric, integer, integer) does not exist
  LINE 80:                     make_date(extract(year from activity_dat...
                               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/chw_analytics/models/starter_code/chw_activity_monthly.sql
[0m17:25:29.299655 [info ] [MainThread]: 
[0m17:25:29.299827 [info ] [MainThread]:   compiled code at target/compiled/chw_analytics/models/starter_code/chw_activity_monthly.sql
[0m17:25:29.299968 [info ] [MainThread]: 
[0m17:25:29.300133 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:25:29.302416 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6029228, "process_in_blocks": "0", "process_kernel_time": 0.20909, "process_mem_max_rss": "142360576", "process_out_blocks": "0", "process_user_time": 1.074875}
[0m17:25:29.302642 [debug] [MainThread]: Command `dbt run` failed at 17:25:29.302604 after 0.60 seconds
[0m17:25:29.302849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ab3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089a85d0>]}
[0m17:25:29.303040 [debug] [MainThread]: Flushing usage events
[0m17:25:30.542535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:06.058626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107318f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738ff90>]}


============================== 17:27:06.061278 | 9a130f08-8316-47db-978f-b4ccdf4428af ==============================
[0m17:27:06.061278 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:27:06.061634 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'empty': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select chw_activity_monthly', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'introspect': 'True', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'debug': 'False', 'partial_parse': 'True'}
[0m17:27:06.137410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a130f08-8316-47db-978f-b4ccdf4428af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738edd0>]}
[0m17:27:06.163875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a130f08-8316-47db-978f-b4ccdf4428af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b02c10>]}
[0m17:27:06.164371 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:27:06.225416 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:27:06.280433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:27:06.280823 [debug] [MainThread]: Partial parsing: updated file: chw_analytics://models/macros/month_assignment.sql
[0m17:27:06.397534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a130f08-8316-47db-978f-b4ccdf4428af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c85650>]}
[0m17:27:06.436970 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:27:06.438098 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:27:06.444336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a130f08-8316-47db-978f-b4ccdf4428af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1bb90>]}
[0m17:27:06.444620 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 460 macros
[0m17:27:06.444808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a130f08-8316-47db-978f-b4ccdf4428af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d15c50>]}
[0m17:27:06.445510 [info ] [MainThread]: 
[0m17:27:06.445694 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:27:06.445834 [info ] [MainThread]: 
[0m17:27:06.446084 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:27:06.446495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics'
[0m17:27:06.500124 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics"
[0m17:27:06.500379 [debug] [ThreadPool]: On list_chw_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:27:06.500526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:06.523690 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.023 seconds
[0m17:27:06.524554 [debug] [ThreadPool]: On list_chw_analytics: Close
[0m17:27:06.525244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_chw_analytics, now list_chw_analytics_marts)
[0m17:27:06.528476 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:27:06.528826 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts_metrics'
[0m17:27:06.529041 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m17:27:06.530147 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:27:06.530320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:06.530465 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m17:27:06.530708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:06.540032 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:27:06.540266 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:27:06.540470 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:27:06.540694 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m17:27:06.540866 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:27:06.541050 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m17:27:06.545078 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m17:27:06.545690 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m17:27:06.545858 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m17:27:06.546392 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m17:27:06.546547 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m17:27:06.546781 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m17:27:06.549188 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:06.549407 [debug] [MainThread]: On master: BEGIN
[0m17:27:06.549557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:27:06.577218 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m17:27:06.577391 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:06.577606 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:27:06.585198 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m17:27:06.585830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a130f08-8316-47db-978f-b4ccdf4428af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e304d0>]}
[0m17:27:06.586109 [debug] [MainThread]: On master: ROLLBACK
[0m17:27:06.586418 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:06.586583 [debug] [MainThread]: On master: BEGIN
[0m17:27:06.586960 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:27:06.587131 [debug] [MainThread]: On master: COMMIT
[0m17:27:06.587296 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:06.587446 [debug] [MainThread]: On master: COMMIT
[0m17:27:06.587682 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:27:06.587838 [debug] [MainThread]: On master: Close
[0m17:27:06.589094 [debug] [Thread-1 (]: Began running node model.chw_analytics.chw_activity_monthly
[0m17:27:06.589371 [info ] [Thread-1 (]: 1 of 1 START sql incremental model marts_metrics.chw_activity_monthly .......... [RUN]
[0m17:27:06.589600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts, now model.chw_analytics.chw_activity_monthly)
[0m17:27:06.589793 [debug] [Thread-1 (]: Began compiling node model.chw_analytics.chw_activity_monthly
[0m17:27:06.596538 [debug] [Thread-1 (]: Writing injected SQL for node "model.chw_analytics.chw_activity_monthly"
[0m17:27:06.596973 [debug] [Thread-1 (]: Began executing node model.chw_analytics.chw_activity_monthly
[0m17:27:06.625658 [debug] [Thread-1 (]: Writing runtime sql for node "model.chw_analytics.chw_activity_monthly"
[0m17:27:06.626216 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:27:06.626412 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: BEGIN
[0m17:27:06.626584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:06.638941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m17:27:06.639226 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:27:06.639515 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      
  
    

  create  table "chw_analytics"."marts_metrics"."chw_activity_monthly"
  
  
    as
  
  (
    /*
Model: chw_activity_monthly
Description: Monthly aggregation of CHW activities for dashboard performance metrics

TODO: Complete this dbt model to aggregate CHW activities by month

Instructions:
1. Add the dbt config block (materialization, unique_key, incremental_strategy)
2. Filter out invalid records (NULL chv_id, NULL activity_date, deleted records)
3. Use the month_assignment macro to calculate report_month
4. Aggregate metrics: total_activities, unique_households_visited, unique_patients_served, pregnancy_visits, child_assessments, family_planning_visits
5. GROUP BY chv_id and report_month
6. Add incremental logic 
*/

-- ============================================
-- dbt Configuration
-- ============================================



-- ============================================
-- Main Query
-- ============================================

with source_data as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        is_deleted,
        created_at,
        updated_at
    from "chw_analytics"."marts"."fct_chv_activity"

    where 1=1
        -- Filter out invalid records as per business requirements
        and chv_id is not null
        and activity_date is not null  
        and is_deleted = false


),

with_report_month as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        -- Use the month_assignment macro to calculate report_month
        


    case 
        -- Activities on/after 26th go to next month
        when extract(day from activity_date) >= 26 then
            case 
                -- If it's December, go to January of next year
                when extract(month from activity_date) = 12 then
                    make_date(extract(year from activity_date) + 1, 1, 1)
                -- Otherwise, go to next month
                else
                    date_trunc('month', activity_date + interval '1 month')
            end
        -- Activities before 26th stay in current month  
        else
            date_trunc('month', activity_date)
    end
    

 as report_month

    from source_data

),

aggregated as (

    select
        chv_id,
        report_month,
        -- Calculate all required metrics
        count(*) as total_activities,
        count(distinct household_id) as unique_households_visited,
        count(distinct patient_id) as unique_patients_served,
        count(case when activity_type = 'pregnancy_visit' then 1 end) as pregnancy_visits,
        count(case when activity_type = 'child_assessment' then 1 end) as child_assessments,
        count(case when activity_type = 'family_planning' then 1 end) as family_planning_visits

    from with_report_month
    group by chv_id, report_month

)

-- ============================================
-- Incremental Logic
-- ============================================


    select * from aggregated


  );
  
  
[0m17:27:06.641146 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function make_date(numeric, integer, integer) does not exist
LINE 80:                     make_date(extract(year from activity_dat...
                             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m17:27:06.641349 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: ROLLBACK
[0m17:27:06.641832 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: Close
[0m17:27:06.644273 [debug] [Thread-1 (]: Database Error in model chw_activity_monthly (models/starter_code/chw_activity_monthly.sql)
  function make_date(numeric, integer, integer) does not exist
  LINE 80:                     make_date(extract(year from activity_dat...
                               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/chw_analytics/models/starter_code/chw_activity_monthly.sql
[0m17:27:06.645270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a130f08-8316-47db-978f-b4ccdf4428af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1a050>]}
[0m17:27:06.645642 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model marts_metrics.chw_activity_monthly . [[31mERROR[0m in 0.05s]
[0m17:27:06.645933 [debug] [Thread-1 (]: Finished running node model.chw_analytics.chw_activity_monthly
[0m17:27:06.646176 [debug] [Thread-7 (]: Marking all children of 'model.chw_analytics.chw_activity_monthly' to be skipped because of status 'error'.  Reason: Database Error in model chw_activity_monthly (models/starter_code/chw_activity_monthly.sql)
  function make_date(numeric, integer, integer) does not exist
  LINE 80:                     make_date(extract(year from activity_dat...
                               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/chw_analytics/models/starter_code/chw_activity_monthly.sql.
[0m17:27:06.647104 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:06.647310 [debug] [MainThread]: On master: BEGIN
[0m17:27:06.647471 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:27:06.657574 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:27:06.657820 [debug] [MainThread]: On master: COMMIT
[0m17:27:06.657983 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:06.658130 [debug] [MainThread]: On master: COMMIT
[0m17:27:06.658451 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:27:06.658614 [debug] [MainThread]: On master: Close
[0m17:27:06.658824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:06.658969 [debug] [MainThread]: Connection 'model.chw_analytics.chw_activity_monthly' was properly closed.
[0m17:27:06.659105 [debug] [MainThread]: Connection 'list_chw_analytics_marts_metrics' was properly closed.
[0m17:27:06.659269 [info ] [MainThread]: 
[0m17:27:06.659437 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m17:27:06.659771 [debug] [MainThread]: Command end result
[0m17:27:06.671704 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:27:06.672827 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:27:06.675963 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m17:27:06.676159 [info ] [MainThread]: 
[0m17:27:06.676366 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:27:06.676534 [info ] [MainThread]: 
[0m17:27:06.676732 [error] [MainThread]: [31mFailure in model chw_activity_monthly (models/starter_code/chw_activity_monthly.sql)[0m
[0m17:27:06.676929 [error] [MainThread]:   Database Error in model chw_activity_monthly (models/starter_code/chw_activity_monthly.sql)
  function make_date(numeric, integer, integer) does not exist
  LINE 80:                     make_date(extract(year from activity_dat...
                               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/chw_analytics/models/starter_code/chw_activity_monthly.sql
[0m17:27:06.677085 [info ] [MainThread]: 
[0m17:27:06.677257 [info ] [MainThread]:   compiled code at target/compiled/chw_analytics/models/starter_code/chw_activity_monthly.sql
[0m17:27:06.677405 [info ] [MainThread]: 
[0m17:27:06.677579 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:27:06.679260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6559259, "process_in_blocks": "0", "process_kernel_time": 0.181067, "process_mem_max_rss": "144441344", "process_out_blocks": "0", "process_user_time": 1.141228}
[0m17:27:06.679502 [debug] [MainThread]: Command `dbt run` failed at 17:27:06.679458 after 0.66 seconds
[0m17:27:06.679712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028f1110>]}
[0m17:27:06.679897 [debug] [MainThread]: Flushing usage events
[0m17:27:08.236276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:52.336370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aba3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2ffd0>]}


============================== 17:27:52.338758 | 768b0482-c96b-4ae2-bd82-3df65ef56a60 ==============================
[0m17:27:52.338758 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:27:52.339110 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select chw_activity_monthly', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'target_path': 'None', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'printer_width': '80', 'empty': 'False'}
[0m17:28:01.034302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d76450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d685d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ddffd0>]}


============================== 17:28:01.036860 | 3f5fd1ad-dcb3-43ca-8c4e-ec10c0f1b124 ==============================
[0m17:28:01.036860 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:28:01.037213 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select chw_activity_monthly', 'debug': 'False', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'fail_fast': 'False', 'write_json': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'quiet': 'False', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'empty': 'False'}
[0m17:28:01.116359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f5fd1ad-dcb3-43ca-8c4e-ec10c0f1b124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ebe0d0>]}
[0m17:28:01.143575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f5fd1ad-dcb3-43ca-8c4e-ec10c0f1b124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059da810>]}
[0m17:28:01.144186 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:28:01.204372 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:28:01.205042 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:28:01.205290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f5fd1ad-dcb3-43ca-8c4e-ec10c0f1b124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120dcfc50>]}
[0m17:28:01.763838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f5fd1ad-dcb3-43ca-8c4e-ec10c0f1b124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b4b550>]}
[0m17:28:01.806491 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:28:01.807770 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:28:01.815202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f5fd1ad-dcb3-43ca-8c4e-ec10c0f1b124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122dd0c50>]}
[0m17:28:01.815512 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 460 macros
[0m17:28:01.815694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f5fd1ad-dcb3-43ca-8c4e-ec10c0f1b124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1229be590>]}
[0m17:28:01.816358 [info ] [MainThread]: 
[0m17:28:01.816549 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:28:01.816688 [info ] [MainThread]: 
[0m17:28:01.816926 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:28:01.817310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics'
[0m17:28:01.844603 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics"
[0m17:28:01.844876 [debug] [ThreadPool]: On list_chw_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:28:01.845037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:01.869651 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m17:28:01.870623 [debug] [ThreadPool]: On list_chw_analytics: Close
[0m17:28:01.871421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_chw_analytics, now list_chw_analytics_marts_metrics)
[0m17:28:01.871766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts'
[0m17:28:01.874894 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:28:01.876185 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:28:01.876377 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m17:28:01.876519 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m17:28:01.876658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:01.876792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:01.897144 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m17:28:01.897491 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:28:01.897679 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m17:28:01.897884 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m17:28:01.898179 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:28:01.898341 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m17:28:01.906242 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m17:28:01.906484 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:28:01.907251 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m17:28:01.907815 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m17:28:01.908177 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m17:28:01.908369 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m17:28:01.910941 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:01.911137 [debug] [MainThread]: On master: BEGIN
[0m17:28:01.911270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:01.923045 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:28:01.923337 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:01.923559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:28:01.930831 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m17:28:01.931507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f5fd1ad-dcb3-43ca-8c4e-ec10c0f1b124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1229d0990>]}
[0m17:28:01.931792 [debug] [MainThread]: On master: ROLLBACK
[0m17:28:01.932122 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:01.932302 [debug] [MainThread]: On master: BEGIN
[0m17:28:01.932742 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:28:01.932910 [debug] [MainThread]: On master: COMMIT
[0m17:28:01.933047 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:01.933179 [debug] [MainThread]: On master: COMMIT
[0m17:28:01.933428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:28:01.933578 [debug] [MainThread]: On master: Close
[0m17:28:01.934765 [debug] [Thread-1 (]: Began running node model.chw_analytics.chw_activity_monthly
[0m17:28:01.935057 [info ] [Thread-1 (]: 1 of 1 START sql incremental model marts_metrics.chw_activity_monthly .......... [RUN]
[0m17:28:01.935294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts_metrics, now model.chw_analytics.chw_activity_monthly)
[0m17:28:01.935476 [debug] [Thread-1 (]: Began compiling node model.chw_analytics.chw_activity_monthly
[0m17:28:01.940783 [debug] [Thread-1 (]: Writing injected SQL for node "model.chw_analytics.chw_activity_monthly"
[0m17:28:01.941533 [debug] [Thread-1 (]: Began executing node model.chw_analytics.chw_activity_monthly
[0m17:28:01.968288 [debug] [Thread-1 (]: Writing runtime sql for node "model.chw_analytics.chw_activity_monthly"
[0m17:28:01.969105 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:28:01.969300 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: BEGIN
[0m17:28:01.969477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:01.982285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m17:28:01.982618 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:28:01.982892 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      
  
    

  create  table "chw_analytics"."marts_metrics"."chw_activity_monthly"
  
  
    as
  
  (
    /*
Model: chw_activity_monthly
Description: Monthly aggregation of CHW activities for dashboard performance metrics

TODO: Complete this dbt model to aggregate CHW activities by month

Instructions:
1. Add the dbt config block (materialization, unique_key, incremental_strategy)
2. Filter out invalid records (NULL chv_id, NULL activity_date, deleted records)
3. Use the month_assignment macro to calculate report_month
4. Aggregate metrics: total_activities, unique_households_visited, unique_patients_served, pregnancy_visits, child_assessments, family_planning_visits
5. GROUP BY chv_id and report_month
6. Add incremental logic 
*/

-- ============================================
-- dbt Configuration
-- ============================================



-- ============================================
-- Main Query
-- ============================================

with source_data as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        is_deleted,
        created_at,
        updated_at
    from "chw_analytics"."marts"."fct_chv_activity"

    where 1=1
        -- Filter out invalid records as per business requirements
        and chv_id is not null
        and activity_date is not null  
        and is_deleted = false


),

with_report_month as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        -- Use the month_assignment macro to calculate report_month
        


    case 
        -- Activities on/after 26th go to next month
        when extract(day from activity_date) >= 26 then
            date_trunc('month', activity_date + interval '1 month')
        -- Activities before 26th stay in current month  
        else
            date_trunc('month', activity_date)
    end
    

 as report_month

    from source_data

),

aggregated as (

    select
        chv_id,
        report_month,
        -- Calculate all required metrics
        count(*) as total_activities,
        count(distinct household_id) as unique_households_visited,
        count(distinct patient_id) as unique_patients_served,
        count(case when activity_type = 'pregnancy_visit' then 1 end) as pregnancy_visits,
        count(case when activity_type = 'child_assessment' then 1 end) as child_assessments,
        count(case when activity_type = 'family_planning' then 1 end) as family_planning_visits

    from with_report_month
    group by chv_id, report_month

)

-- ============================================
-- Incremental Logic
-- ============================================


    select * from aggregated


  );
  
  
[0m17:28:01.992787 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.010 seconds
[0m17:28:02.001131 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: COMMIT
[0m17:28:02.001433 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:28:02.001610 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: COMMIT
[0m17:28:02.004540 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:28:02.005523 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: Close
[0m17:28:02.006675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5fd1ad-dcb3-43ca-8c4e-ec10c0f1b124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1229a00d0>]}
[0m17:28:02.007081 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model marts_metrics.chw_activity_monthly ..... [[32mSELECT 6[0m in 0.07s]
[0m17:28:02.007369 [debug] [Thread-1 (]: Finished running node model.chw_analytics.chw_activity_monthly
[0m17:28:02.008135 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:02.008385 [debug] [MainThread]: On master: BEGIN
[0m17:28:02.008550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:28:02.020299 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:28:02.020585 [debug] [MainThread]: On master: COMMIT
[0m17:28:02.020764 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:02.020916 [debug] [MainThread]: On master: COMMIT
[0m17:28:02.021376 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:28:02.021573 [debug] [MainThread]: On master: Close
[0m17:28:02.021799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:02.021940 [debug] [MainThread]: Connection 'model.chw_analytics.chw_activity_monthly' was properly closed.
[0m17:28:02.022071 [debug] [MainThread]: Connection 'list_chw_analytics_marts' was properly closed.
[0m17:28:02.022230 [info ] [MainThread]: 
[0m17:28:02.022402 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m17:28:02.022730 [debug] [MainThread]: Command end result
[0m17:28:02.034724 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:28:02.035776 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:28:02.038760 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m17:28:02.038961 [info ] [MainThread]: 
[0m17:28:02.039185 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:02.039347 [info ] [MainThread]: 
[0m17:28:02.039515 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:28:02.041139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0444838, "process_in_blocks": "0", "process_kernel_time": 0.19963, "process_mem_max_rss": "148488192", "process_out_blocks": "0", "process_user_time": 1.50243}
[0m17:28:02.041376 [debug] [MainThread]: Command `dbt run` succeeded at 17:28:02.041336 after 1.04 seconds
[0m17:28:02.041577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c9d410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e1d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d6b550>]}
[0m17:28:02.041763 [debug] [MainThread]: Flushing usage events
[0m17:28:03.223039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:32:18.599911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a211d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d71510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a97f90>]}


============================== 17:32:18.602809 | aba63348-b8da-440f-97a4-3f7d1747da3a ==============================
[0m17:32:18.602809 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:32:18.603168 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'debug': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select chw_activity_monthly --debug', 'log_format': 'default', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'version_check': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m17:32:18.687140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aba63348-b8da-440f-97a4-3f7d1747da3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076dc550>]}
[0m17:32:18.713738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aba63348-b8da-440f-97a4-3f7d1747da3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e6e50>]}
[0m17:32:18.715263 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:32:18.776526 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:32:18.837515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:18.837807 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:18.859292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aba63348-b8da-440f-97a4-3f7d1747da3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b1590>]}
[0m17:32:18.899925 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:32:18.901191 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:32:18.912315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aba63348-b8da-440f-97a4-3f7d1747da3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108435b90>]}
[0m17:32:18.912649 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 460 macros
[0m17:32:18.912824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba63348-b8da-440f-97a4-3f7d1747da3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f4c10>]}
[0m17:32:18.913545 [info ] [MainThread]: 
[0m17:32:18.913726 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:32:18.913868 [info ] [MainThread]: 
[0m17:32:18.914136 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:32:18.914593 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics'
[0m17:32:18.944568 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics"
[0m17:32:18.944835 [debug] [ThreadPool]: On list_chw_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:32:18.945005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:18.967668 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.023 seconds
[0m17:32:18.968517 [debug] [ThreadPool]: On list_chw_analytics: Close
[0m17:32:18.969193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_chw_analytics, now list_chw_analytics_marts)
[0m17:32:18.969419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts_metrics'
[0m17:32:18.972336 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:32:18.973546 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:32:18.973776 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m17:32:18.973948 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m17:32:18.974101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:32:18.974245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:18.989194 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m17:32:18.989498 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:32:18.989687 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m17:32:18.989837 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m17:32:18.990112 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:32:18.990277 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m17:32:18.997471 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:32:18.998251 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m17:32:18.998470 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:32:18.998640 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m17:32:18.999232 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m17:32:18.999679 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m17:32:19.002408 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:19.002674 [debug] [MainThread]: On master: BEGIN
[0m17:32:19.002829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:19.013890 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m17:32:19.014184 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:19.014417 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:32:19.019779 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m17:32:19.020537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aba63348-b8da-440f-97a4-3f7d1747da3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820e510>]}
[0m17:32:19.020847 [debug] [MainThread]: On master: ROLLBACK
[0m17:32:19.021203 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:19.021413 [debug] [MainThread]: On master: BEGIN
[0m17:32:19.021821 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:32:19.022009 [debug] [MainThread]: On master: COMMIT
[0m17:32:19.022167 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:19.022319 [debug] [MainThread]: On master: COMMIT
[0m17:32:19.022579 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:32:19.022741 [debug] [MainThread]: On master: Close
[0m17:32:19.025181 [debug] [Thread-1 (]: Began running node model.chw_analytics.chw_activity_monthly
[0m17:32:19.025535 [info ] [Thread-1 (]: 1 of 1 START sql incremental model marts_metrics.chw_activity_monthly .......... [RUN]
[0m17:32:19.025790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts, now model.chw_analytics.chw_activity_monthly)
[0m17:32:19.025991 [debug] [Thread-1 (]: Began compiling node model.chw_analytics.chw_activity_monthly
[0m17:32:19.034052 [debug] [Thread-1 (]: Writing injected SQL for node "model.chw_analytics.chw_activity_monthly"
[0m17:32:19.034603 [debug] [Thread-1 (]: Began executing node model.chw_analytics.chw_activity_monthly
[0m17:32:19.093417 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:32:19.093909 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

    
  
    

  create temporary table "chw_activity_monthly__dbt_tmp173219050792"
  
  
    as
  
  (
    /*
Model: chw_activity_monthly
Description: Monthly aggregation of CHW activities for dashboard performance metrics

TODO: Complete this dbt model to aggregate CHW activities by month

Instructions:
1. Add the dbt config block (materialization, unique_key, incremental_strategy)
2. Filter out invalid records (NULL chv_id, NULL activity_date, deleted records)
3. Use the month_assignment macro to calculate report_month
4. Aggregate metrics: total_activities, unique_households_visited, unique_patients_served, pregnancy_visits, child_assessments, family_planning_visits
5. GROUP BY chv_id and report_month
6. Add incremental logic 
*/

-- ============================================
-- dbt Configuration
-- ============================================



-- ============================================
-- Main Query
-- ============================================

with source_data as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        is_deleted,
        created_at,
        updated_at
    from "chw_analytics"."marts"."fct_chv_activity"

    where 1=1
        -- Filter out invalid records as per business requirements
        and chv_id is not null
        and activity_date is not null  
        and is_deleted = false


),

with_report_month as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        -- Use the month_assignment macro to calculate report_month
        


    case 
        -- Activities on/after 26th go to next month
        when extract(day from activity_date) >= 26 then
            date_trunc('month', activity_date + interval '1 month')
        -- Activities before 26th stay in current month  
        else
            date_trunc('month', activity_date)
    end
    

 as report_month

    from source_data

),

aggregated as (

    select
        chv_id,
        report_month,
        -- Calculate all required metrics
        count(*) as total_activities,
        count(distinct household_id) as unique_households_visited,
        count(distinct patient_id) as unique_patients_served,
        count(case when activity_type = 'pregnancy_visit' then 1 end) as pregnancy_visits,
        count(case when activity_type = 'child_assessment' then 1 end) as child_assessments,
        count(case when activity_type = 'family_planning' then 1 end) as family_planning_visits

    from with_report_month
    group by chv_id, report_month

)

-- ============================================
-- Incremental Logic
-- ============================================


    select * from aggregated
    where (chv_id, report_month) in (
        select chv_id, report_month from "chw_analytics"."marts_metrics"."chw_activity_monthly"
        union
        select chv_id, report_month from aggregated
    )


  );
  
  
[0m17:32:19.094299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:19.113310 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.019 seconds
[0m17:32:19.121031 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:32:19.121315 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: BEGIN
[0m17:32:19.121839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m17:32:19.122154 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:32:19.122365 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'chw_activity_monthly__dbt_tmp173219050792'
        
      order by ordinal_position

  
[0m17:32:19.136250 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.014 seconds
[0m17:32:19.139674 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:32:19.139992 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chw_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'chw_activity_monthly'
        
        and table_schema = 'marts_metrics'
        
      order by ordinal_position

  
[0m17:32:19.144295 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m17:32:19.148372 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:32:19.148682 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chw_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'chw_activity_monthly'
        
        and table_schema = 'marts_metrics'
        
      order by ordinal_position

  
[0m17:32:19.153142 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m17:32:19.159312 [debug] [Thread-1 (]: Writing runtime sql for node "model.chw_analytics.chw_activity_monthly"
[0m17:32:19.159903 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:32:19.160138 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      
        delete from "chw_analytics"."marts_metrics"."chw_activity_monthly" as DBT_INTERNAL_DEST
        where (chv_id, report_month) in (
            select distinct chv_id, report_month
            from "chw_activity_monthly__dbt_tmp173219050792" as DBT_INTERNAL_SOURCE
        );

    

    insert into "chw_analytics"."marts_metrics"."chw_activity_monthly" ("chv_id", "report_month", "total_activities", "unique_households_visited", "unique_patients_served", "pregnancy_visits", "child_assessments", "family_planning_visits")
    (
        select "chv_id", "report_month", "total_activities", "unique_households_visited", "unique_patients_served", "pregnancy_visits", "child_assessments", "family_planning_visits"
        from "chw_activity_monthly__dbt_tmp173219050792"
    )
  
[0m17:32:19.162470 [debug] [Thread-1 (]: SQL status: INSERT 0 6 in 0.002 seconds
[0m17:32:19.169618 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: COMMIT
[0m17:32:19.169980 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:32:19.170221 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: COMMIT
[0m17:32:19.171392 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:32:19.172324 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: Close
[0m17:32:19.173354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aba63348-b8da-440f-97a4-3f7d1747da3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108333150>]}
[0m17:32:19.173792 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model marts_metrics.chw_activity_monthly ..... [[32mINSERT 0 6[0m in 0.15s]
[0m17:32:19.174077 [debug] [Thread-1 (]: Finished running node model.chw_analytics.chw_activity_monthly
[0m17:32:19.174759 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:19.174981 [debug] [MainThread]: On master: BEGIN
[0m17:32:19.175150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:32:19.189674 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m17:32:19.189968 [debug] [MainThread]: On master: COMMIT
[0m17:32:19.190126 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:19.190308 [debug] [MainThread]: On master: COMMIT
[0m17:32:19.190607 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:32:19.190817 [debug] [MainThread]: On master: Close
[0m17:32:19.191064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:19.191219 [debug] [MainThread]: Connection 'model.chw_analytics.chw_activity_monthly' was properly closed.
[0m17:32:19.191357 [debug] [MainThread]: Connection 'list_chw_analytics_marts_metrics' was properly closed.
[0m17:32:19.191527 [info ] [MainThread]: 
[0m17:32:19.191684 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m17:32:19.192001 [debug] [MainThread]: Command end result
[0m17:32:19.203443 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:32:19.204505 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:32:19.207625 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m17:32:19.207866 [info ] [MainThread]: 
[0m17:32:19.208097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:19.208243 [info ] [MainThread]: 
[0m17:32:19.208386 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:32:19.210852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6464232, "process_in_blocks": "0", "process_kernel_time": 0.219283, "process_mem_max_rss": "140345344", "process_out_blocks": "0", "process_user_time": 1.094718}
[0m17:32:19.211177 [debug] [MainThread]: Command `dbt run` succeeded at 17:32:19.211131 after 0.65 seconds
[0m17:32:19.211418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aabe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aaa190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030923d0>]}
[0m17:32:19.211652 [debug] [MainThread]: Flushing usage events
[0m17:32:20.555726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:20.611806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d22ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9ff90>]}


============================== 17:33:20.614179 | 36f28652-10ec-48ee-b38a-996de0a1574e ==============================
[0m17:33:20.614179 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:33:20.614600 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/mzaza/Downloads/main_task/logs', 'log_format': 'default', 'invocation_command': 'dbt run --select chw_activity_monthly --full-refresh', 'empty': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'quiet': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'debug': 'False', 'write_json': 'True', 'no_print': 'None'}
[0m17:33:20.689840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36f28652-10ec-48ee-b38a-996de0a1574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de7f90>]}
[0m17:33:20.716004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36f28652-10ec-48ee-b38a-996de0a1574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ea510>]}
[0m17:33:20.716512 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:33:20.774504 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:33:20.831097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:33:20.831407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:33:20.853061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36f28652-10ec-48ee-b38a-996de0a1574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863add0>]}
[0m17:33:20.893450 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:33:20.894578 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:33:20.901562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36f28652-10ec-48ee-b38a-996de0a1574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084fefd0>]}
[0m17:33:20.901855 [info ] [MainThread]: Found 2 models, 2 data tests, 1 source, 460 macros
[0m17:33:20.902047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f28652-10ec-48ee-b38a-996de0a1574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871fc50>]}
[0m17:33:20.902757 [info ] [MainThread]: 
[0m17:33:20.902962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:33:20.903104 [info ] [MainThread]: 
[0m17:33:20.903376 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:33:20.903804 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics'
[0m17:33:20.926848 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics"
[0m17:33:20.927096 [debug] [ThreadPool]: On list_chw_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:33:20.927246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:20.948775 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.021 seconds
[0m17:33:20.949539 [debug] [ThreadPool]: On list_chw_analytics: Close
[0m17:33:20.950157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_chw_analytics, now list_chw_analytics_marts)
[0m17:33:20.950438 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts_metrics'
[0m17:33:20.953293 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:33:20.954334 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:33:20.954510 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m17:33:20.954658 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m17:33:20.954791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:20.954918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:20.966951 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m17:33:20.967121 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:33:20.967283 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m17:33:20.967849 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m17:33:20.967984 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:33:20.968130 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m17:33:20.973961 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:33:20.974551 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m17:33:20.974710 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m17:33:20.975221 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m17:33:20.975369 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m17:33:20.975706 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m17:33:20.977911 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:20.978085 [debug] [MainThread]: On master: BEGIN
[0m17:33:20.978225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:20.987488 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m17:33:20.987663 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:20.987870 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:33:20.993630 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m17:33:20.994219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f28652-10ec-48ee-b38a-996de0a1574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c0a10>]}
[0m17:33:20.994462 [debug] [MainThread]: On master: ROLLBACK
[0m17:33:20.994765 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:20.994910 [debug] [MainThread]: On master: BEGIN
[0m17:33:20.995317 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:33:20.995466 [debug] [MainThread]: On master: COMMIT
[0m17:33:20.995603 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:20.995738 [debug] [MainThread]: On master: COMMIT
[0m17:33:20.995997 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:33:20.996149 [debug] [MainThread]: On master: Close
[0m17:33:20.997187 [debug] [Thread-1 (]: Began running node model.chw_analytics.chw_activity_monthly
[0m17:33:20.997457 [info ] [Thread-1 (]: 1 of 1 START sql incremental model marts_metrics.chw_activity_monthly .......... [RUN]
[0m17:33:20.997674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts, now model.chw_analytics.chw_activity_monthly)
[0m17:33:20.997858 [debug] [Thread-1 (]: Began compiling node model.chw_analytics.chw_activity_monthly
[0m17:33:21.005948 [debug] [Thread-1 (]: Writing injected SQL for node "model.chw_analytics.chw_activity_monthly"
[0m17:33:21.006501 [debug] [Thread-1 (]: Began executing node model.chw_analytics.chw_activity_monthly
[0m17:33:21.066328 [debug] [Thread-1 (]: Writing runtime sql for node "model.chw_analytics.chw_activity_monthly"
[0m17:33:21.066994 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:33:21.067185 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: BEGIN
[0m17:33:21.067346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:21.079893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m17:33:21.080100 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:33:21.080362 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      
  
    

  create  table "chw_analytics"."marts_metrics"."chw_activity_monthly__dbt_tmp"
  
  
    as
  
  (
    /*
Model: chw_activity_monthly
Description: Monthly aggregation of CHW activities for dashboard performance metrics

TODO: Complete this dbt model to aggregate CHW activities by month

Instructions:
1. Add the dbt config block (materialization, unique_key, incremental_strategy)
2. Filter out invalid records (NULL chv_id, NULL activity_date, deleted records)
3. Use the month_assignment macro to calculate report_month
4. Aggregate metrics: total_activities, unique_households_visited, unique_patients_served, pregnancy_visits, child_assessments, family_planning_visits
5. GROUP BY chv_id and report_month
6. Add incremental logic 
*/

-- ============================================
-- dbt Configuration
-- ============================================



-- ============================================
-- Main Query
-- ============================================

with source_data as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        is_deleted,
        created_at,
        updated_at
    from "chw_analytics"."marts"."fct_chv_activity"

    where 1=1
        -- Filter out invalid records as per business requirements
        and chv_id is not null
        and activity_date is not null  
        and is_deleted = false


),

with_report_month as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        -- Use the month_assignment macro to calculate report_month
        


    case 
        -- Activities on/after 26th go to next month
        when extract(day from activity_date) >= 26 then
            date_trunc('month', activity_date + interval '1 month')
        -- Activities before 26th stay in current month  
        else
            date_trunc('month', activity_date)
    end
    

 as report_month

    from source_data

),

aggregated as (

    select
        chv_id,
        report_month,
        -- Calculate all required metrics
        count(*) as total_activities,
        count(distinct household_id) as unique_households_visited,
        count(distinct patient_id) as unique_patients_served,
        count(case when activity_type = 'pregnancy_visit' then 1 end) as pregnancy_visits,
        count(case when activity_type = 'child_assessment' then 1 end) as child_assessments,
        count(case when activity_type = 'family_planning' then 1 end) as family_planning_visits

    from with_report_month
    group by chv_id, report_month

)

-- ============================================
-- Incremental Logic
-- ============================================


    select * from aggregated


  );
  
  
[0m17:33:21.086708 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m17:33:21.091453 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:33:21.091672 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */
alter table "chw_analytics"."marts_metrics"."chw_activity_monthly" rename to "chw_activity_monthly__dbt_backup"
[0m17:33:21.092372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:21.093832 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:33:21.094023 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */
alter table "chw_analytics"."marts_metrics"."chw_activity_monthly__dbt_tmp" rename to "chw_activity_monthly"
[0m17:33:21.095415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:21.102979 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: COMMIT
[0m17:33:21.103240 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:33:21.103416 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: COMMIT
[0m17:33:21.104584 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:33:21.107738 [debug] [Thread-1 (]: Applying DROP to: "chw_analytics"."marts_metrics"."chw_activity_monthly__dbt_backup"
[0m17:33:21.110009 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m17:33:21.110270 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */
drop table if exists "chw_analytics"."marts_metrics"."chw_activity_monthly__dbt_backup" cascade
[0m17:33:21.112171 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:33:21.113442 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: Close
[0m17:33:21.114284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36f28652-10ec-48ee-b38a-996de0a1574e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a432d0>]}
[0m17:33:21.114662 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model marts_metrics.chw_activity_monthly ..... [[32mSELECT 6[0m in 0.12s]
[0m17:33:21.114956 [debug] [Thread-1 (]: Finished running node model.chw_analytics.chw_activity_monthly
[0m17:33:21.115820 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:21.115979 [debug] [MainThread]: On master: BEGIN
[0m17:33:21.116108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:21.130484 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m17:33:21.130756 [debug] [MainThread]: On master: COMMIT
[0m17:33:21.130903 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:21.131034 [debug] [MainThread]: On master: COMMIT
[0m17:33:21.131335 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:33:21.131534 [debug] [MainThread]: On master: Close
[0m17:33:21.131762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:21.131904 [debug] [MainThread]: Connection 'model.chw_analytics.chw_activity_monthly' was properly closed.
[0m17:33:21.132031 [debug] [MainThread]: Connection 'list_chw_analytics_marts_metrics' was properly closed.
[0m17:33:21.132181 [info ] [MainThread]: 
[0m17:33:21.132341 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m17:33:21.132677 [debug] [MainThread]: Command end result
[0m17:33:21.144075 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:33:21.145170 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:33:21.148099 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m17:33:21.148276 [info ] [MainThread]: 
[0m17:33:21.148480 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:21.148628 [info ] [MainThread]: 
[0m17:33:21.148788 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:33:21.150389 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.573586, "process_in_blocks": "0", "process_kernel_time": 0.176798, "process_mem_max_rss": "141754368", "process_out_blocks": "0", "process_user_time": 1.071516}
[0m17:33:21.150613 [debug] [MainThread]: Command `dbt run` succeeded at 17:33:21.150575 after 0.57 seconds
[0m17:33:21.150812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033463d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103346410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103346610>]}
[0m17:33:21.150994 [debug] [MainThread]: Flushing usage events
[0m17:33:23.019698 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:51.593255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aec910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b5ffd0>]}


============================== 17:39:51.595656 | 231a14d0-840d-4cb5-a3c3-22ef3188b976 ==============================
[0m17:39:51.595656 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:39:51.595979 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'introspect': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'warn_error': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select chw_activity_monthly', 'fail_fast': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'no_print': 'None', 'log_path': '/Users/mzaza/Downloads/main_task/logs'}
[0m17:39:51.671778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '231a14d0-840d-4cb5-a3c3-22ef3188b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d9fc10>]}
[0m17:39:51.698118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '231a14d0-840d-4cb5-a3c3-22ef3188b976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c6b90>]}
[0m17:39:51.698633 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:39:51.755424 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:39:51.813314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:39:51.813714 [debug] [MainThread]: Partial parsing: added file: chw_analytics://models/starter_code/schema.yml
[0m17:39:51.903212 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/starter_code/schema.yml:
  	test definition dictionary must have exactly one key, got [('name', 'unique_chw_month_combination'), ('description', 'Ensures each CHW-month combination appears exactly once'), ('config', {'severity': 'error'}), ('assert', ['count(*) = count(distinct chv_id || report_month)'])] instead (4 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:39:51.905955 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.34978476, "process_in_blocks": "0", "process_kernel_time": 0.165692, "process_mem_max_rss": "130990080", "process_out_blocks": "0", "process_user_time": 0.927942}
[0m17:39:51.906238 [debug] [MainThread]: Command `dbt test` failed at 17:39:51.906189 after 0.35 seconds
[0m17:39:51.906458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b82d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a406fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a601890>]}
[0m17:39:51.906654 [debug] [MainThread]: Flushing usage events
[0m17:39:53.151391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:56.015245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f4fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f4ff90>]}


============================== 17:40:56.017703 | a89ba9f2-b7cb-4f1f-8d8d-2cbbc15fc7a8 ==============================
[0m17:40:56.017703 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:40:56.018032 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --select chw_activity_monthly', 'static_parser': 'True', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'quiet': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'log_format': 'default', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'debug': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'fail_fast': 'False', 'no_print': 'None'}
[0m17:40:56.093915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a89ba9f2-b7cb-4f1f-8d8d-2cbbc15fc7a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c85fd0>]}
[0m17:40:56.120543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a89ba9f2-b7cb-4f1f-8d8d-2cbbc15fc7a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10763ea10>]}
[0m17:40:56.121070 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:40:56.178894 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:40:56.235216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:40:56.235575 [debug] [MainThread]: Partial parsing: added file: chw_analytics://models/starter_code/schema.yml
[0m17:40:56.323298 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `unique`. Arguments to generic tests should be
nested under the `arguments` property.`
[0m17:40:56.323639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a89ba9f2-b7cb-4f1f-8d8d-2cbbc15fc7a8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a925810>]}
[0m17:40:56.361067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a89ba9f2-b7cb-4f1f-8d8d-2cbbc15fc7a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5ad310>]}
[0m17:40:56.432409 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:40:56.433447 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:40:56.499262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a89ba9f2-b7cb-4f1f-8d8d-2cbbc15fc7a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad41090>]}
[0m17:40:56.499574 [info ] [MainThread]: Found 2 models, 12 data tests, 1 source, 460 macros
[0m17:40:56.499750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a89ba9f2-b7cb-4f1f-8d8d-2cbbc15fc7a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa39f10>]}
[0m17:40:56.500612 [info ] [MainThread]: 
[0m17:40:56.500787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:40:56.500922 [info ] [MainThread]: 
[0m17:40:56.501146 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:40:56.501693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts_metrics'
[0m17:40:56.502051 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts'
[0m17:40:56.530233 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:40:56.530492 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:40:56.530651 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m17:40:56.530815 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m17:40:56.530952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:56.531085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:56.555704 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m17:40:56.555942 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m17:40:56.556102 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:40:56.556267 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:40:56.556432 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m17:40:56.556617 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m17:40:56.564156 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:40:56.564829 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m17:40:56.565006 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:40:56.565606 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m17:40:56.565758 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m17:40:56.566146 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m17:40:56.568611 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:56.568801 [debug] [MainThread]: On master: BEGIN
[0m17:40:56.568951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:56.580047 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m17:40:56.580310 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:56.580539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:40:56.585508 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m17:40:56.586207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a89ba9f2-b7cb-4f1f-8d8d-2cbbc15fc7a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a2e90>]}
[0m17:40:56.586500 [debug] [MainThread]: On master: ROLLBACK
[0m17:40:56.586879 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:56.587030 [debug] [MainThread]: On master: BEGIN
[0m17:40:56.587411 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:40:56.587556 [debug] [MainThread]: On master: COMMIT
[0m17:40:56.587690 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:56.587820 [debug] [MainThread]: On master: COMMIT
[0m17:40:56.588043 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:40:56.588196 [debug] [MainThread]: On master: Close
[0m17:40:56.589449 [debug] [Thread-1 (]: Began running node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_child_assessments.a0bab8abb3
[0m17:40:56.589699 [debug] [Thread-2 (]: Began running node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_family_planning_visits.64576506de
[0m17:40:56.589913 [info ] [Thread-1 (]: 1 of 10 START test dbt_utils_at_least_one_chw_activity_monthly_child_assessments  [RUN]
[0m17:40:56.590171 [info ] [Thread-2 (]: 2 of 10 START test dbt_utils_at_least_one_chw_activity_monthly_family_planning_visits  [RUN]
[0m17:40:56.590420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts_metrics, now test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_child_assessments.a0bab8abb3)
[0m17:40:56.590597 [debug] [Thread-3 (]: Began running node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_pregnancy_visits.1cd1f11a69
[0m17:40:56.590781 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts, now test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_family_planning_visits.64576506de)
[0m17:40:56.590946 [debug] [Thread-4 (]: Began running node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_total_activities.c5e3ec7994
[0m17:40:56.591118 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_child_assessments.a0bab8abb3
[0m17:40:56.591289 [info ] [Thread-3 (]: 3 of 10 START test dbt_utils_at_least_one_chw_activity_monthly_pregnancy_visits  [RUN]
[0m17:40:56.591468 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_family_planning_visits.64576506de
[0m17:40:56.591638 [info ] [Thread-4 (]: 4 of 10 START test dbt_utils_at_least_one_chw_activity_monthly_total_activities  [RUN]
[0m17:40:56.596399 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_pregnancy_visits.1cd1f11a69'
[0m17:40:56.599089 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_total_activities.c5e3ec7994'
[0m17:40:56.599341 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_pregnancy_visits.1cd1f11a69
[0m17:40:56.599607 [debug] [Thread-4 (]: Began compiling node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_total_activities.c5e3ec7994
[0m17:40:56.609444 [debug] [Thread-2 (]: Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_family_planning_visits (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:56.610009 [debug] [Thread-3 (]: Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_pregnancy_visits (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:56.610530 [debug] [Thread-4 (]: Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_total_activities (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:56.611293 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_child_assessments (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:56.610856 [error] [Thread-2 (]: 2 of 10 ERROR dbt_utils_at_least_one_chw_activity_monthly_family_planning_visits  [[31mERROR[0m in 0.02s]
[0m17:40:56.611592 [error] [Thread-3 (]: 3 of 10 ERROR dbt_utils_at_least_one_chw_activity_monthly_pregnancy_visits ..... [[31mERROR[0m in 0.02s]
[0m17:40:56.611838 [error] [Thread-4 (]: 4 of 10 ERROR dbt_utils_at_least_one_chw_activity_monthly_total_activities ..... [[31mERROR[0m in 0.01s]
[0m17:40:56.612084 [error] [Thread-1 (]: 1 of 10 ERROR dbt_utils_at_least_one_chw_activity_monthly_child_assessments .... [[31mERROR[0m in 0.02s]
[0m17:40:56.612333 [debug] [Thread-2 (]: Finished running node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_family_planning_visits.64576506de
[0m17:40:56.612560 [debug] [Thread-3 (]: Finished running node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_pregnancy_visits.1cd1f11a69
[0m17:40:56.612769 [debug] [Thread-4 (]: Finished running node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_total_activities.c5e3ec7994
[0m17:40:56.612981 [debug] [Thread-1 (]: Finished running node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_child_assessments.a0bab8abb3
[0m17:40:56.613173 [debug] [Thread-2 (]: Began running node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_unique_households_visited.0fb075fa3a
[0m17:40:56.613353 [debug] [Thread-7 (]: Marking all children of 'test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_family_planning_visits.64576506de' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_family_planning_visits (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:40:56.613546 [debug] [Thread-3 (]: Began running node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_unique_patients_served.35a07709e6
[0m17:40:56.613726 [debug] [Thread-4 (]: Began running node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m17:40:56.613936 [debug] [Thread-1 (]: Began running node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m17:40:56.614154 [info ] [Thread-2 (]: 5 of 10 START test dbt_utils_at_least_one_chw_activity_monthly_unique_households_visited  [RUN]
[0m17:40:56.614706 [debug] [Thread-7 (]: Marking all children of 'test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_pregnancy_visits.1cd1f11a69' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_pregnancy_visits (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:40:56.614920 [info ] [Thread-3 (]: 6 of 10 START test dbt_utils_at_least_one_chw_activity_monthly_unique_patients_served  [RUN]
[0m17:40:56.615120 [info ] [Thread-4 (]: 7 of 10 START test not_null_chw_activity_monthly_chv_id ........................ [RUN]
[0m17:40:56.615313 [info ] [Thread-1 (]: 8 of 10 START test not_null_chw_activity_monthly_report_month .................. [RUN]
[0m17:40:56.615556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_family_planning_visits.64576506de, now test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_unique_households_visited.0fb075fa3a)
[0m17:40:56.615787 [debug] [Thread-7 (]: Marking all children of 'test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_total_activities.c5e3ec7994' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_total_activities (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:40:56.615985 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_pregnancy_visits.1cd1f11a69, now test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_unique_patients_served.35a07709e6)
[0m17:40:56.616185 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_total_activities.c5e3ec7994, now test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa)
[0m17:40:56.616374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_child_assessments.a0bab8abb3, now test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4)
[0m17:40:56.616585 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_unique_households_visited.0fb075fa3a
[0m17:40:56.616838 [debug] [Thread-7 (]: Marking all children of 'test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_child_assessments.a0bab8abb3' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_child_assessments (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:40:56.617020 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_unique_patients_served.35a07709e6
[0m17:40:56.617233 [debug] [Thread-4 (]: Began compiling node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m17:40:56.617417 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m17:40:56.626942 [debug] [Thread-4 (]: Writing injected SQL for node "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m17:40:56.627630 [debug] [Thread-2 (]: Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_unique_households_visited (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:56.628076 [debug] [Thread-3 (]: Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_unique_patients_served (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:56.630002 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m17:40:56.630351 [error] [Thread-2 (]: 5 of 10 ERROR dbt_utils_at_least_one_chw_activity_monthly_unique_households_visited  [[31mERROR[0m in 0.01s]
[0m17:40:56.630674 [error] [Thread-3 (]: 6 of 10 ERROR dbt_utils_at_least_one_chw_activity_monthly_unique_patients_served  [[31mERROR[0m in 0.01s]
[0m17:40:56.631023 [debug] [Thread-2 (]: Finished running node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_unique_households_visited.0fb075fa3a
[0m17:40:56.631291 [debug] [Thread-3 (]: Finished running node test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_unique_patients_served.35a07709e6
[0m17:40:56.631534 [debug] [Thread-2 (]: Began running node test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f
[0m17:40:56.631695 [debug] [Thread-1 (]: Began executing node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m17:40:56.631840 [debug] [Thread-4 (]: Began executing node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m17:40:56.632010 [debug] [Thread-3 (]: Began running node test.chw_analytics.unique_chw_activity_monthly_chv_id__report_month.626f0482d9
[0m17:40:56.632175 [debug] [Thread-7 (]: Marking all children of 'test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_unique_households_visited.0fb075fa3a' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_unique_households_visited (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:40:56.632353 [info ] [Thread-2 (]: 9 of 10 START test unique_chw_activity_monthly_chv_id .......................... [RUN]
[0m17:40:56.640629 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m17:40:56.642017 [debug] [Thread-4 (]: Writing runtime sql for node "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m17:40:56.642280 [info ] [Thread-3 (]: 10 of 10 START test unique_chw_activity_monthly_chv_id__report_month ........... [RUN]
[0m17:40:56.642574 [debug] [Thread-7 (]: Marking all children of 'test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_unique_patients_served.35a07709e6' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_unique_patients_served (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m17:40:56.642831 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_unique_households_visited.0fb075fa3a, now test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f)
[0m17:40:56.643173 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_at_least_one_chw_activity_monthly_unique_patients_served.35a07709e6, now test.chw_analytics.unique_chw_activity_monthly_chv_id__report_month.626f0482d9)
[0m17:40:56.643487 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f
[0m17:40:56.643750 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m17:40:56.643911 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.unique_chw_activity_monthly_chv_id__report_month.626f0482d9
[0m17:40:56.644074 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m17:40:56.647033 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"
[0m17:40:56.647250 [debug] [Thread-4 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: BEGIN
[0m17:40:56.649579 [debug] [Thread-1 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: BEGIN
[0m17:40:56.649861 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:40:56.650174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:56.650476 [debug] [Thread-2 (]: Began executing node test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f
[0m17:40:56.651843 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"
[0m17:40:56.652637 [debug] [Thread-3 (]: Compilation Error in test unique_chw_activity_monthly_chv_id__report_month (models/starter_code/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'combination_of_columns'
[0m17:40:56.652940 [error] [Thread-3 (]: 10 of 10 ERROR unique_chw_activity_monthly_chv_id__report_month ................ [[31mERROR[0m in 0.01s]
[0m17:40:56.653217 [debug] [Thread-3 (]: Finished running node test.chw_analytics.unique_chw_activity_monthly_chv_id__report_month.626f0482d9
[0m17:40:56.653423 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"
[0m17:40:56.653669 [debug] [Thread-7 (]: Marking all children of 'test.chw_analytics.unique_chw_activity_monthly_chv_id__report_month.626f0482d9' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_chw_activity_monthly_chv_id__report_month (models/starter_code/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'combination_of_columns'.
[0m17:40:56.653876 [debug] [Thread-2 (]: On test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f: BEGIN
[0m17:40:56.654110 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:40:56.665324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m17:40:56.665591 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m17:40:56.665768 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m17:40:56.665989 [debug] [Thread-1 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select report_month
from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where report_month is null



  
  
      
    ) dbt_internal_test
[0m17:40:56.666226 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m17:40:56.666469 [debug] [Thread-4 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select chv_id
from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where chv_id is null



  
  
      
    ) dbt_internal_test
[0m17:40:56.666647 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m17:40:56.666836 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"
[0m17:40:56.667010 [debug] [Thread-2 (]: On test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    chv_id as unique_field,
    count(*) as n_records

from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where chv_id is not null
group by chv_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:40:56.670515 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:40:56.672683 [debug] [Thread-4 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: ROLLBACK
[0m17:40:56.672908 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m17:40:56.673074 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m17:40:56.673782 [debug] [Thread-1 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: ROLLBACK
[0m17:40:56.674428 [debug] [Thread-2 (]: On test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f: ROLLBACK
[0m17:40:56.674599 [debug] [Thread-4 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: Close
[0m17:40:56.675172 [debug] [Thread-1 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: Close
[0m17:40:56.675024 [info ] [Thread-4 (]: 7 of 10 PASS not_null_chw_activity_monthly_chv_id .............................. [[32mPASS[0m in 0.06s]
[0m17:40:56.675506 [debug] [Thread-4 (]: Finished running node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m17:40:56.675686 [debug] [Thread-2 (]: On test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f: Close
[0m17:40:56.675950 [info ] [Thread-1 (]: 8 of 10 PASS not_null_chw_activity_monthly_report_month ........................ [[32mPASS[0m in 0.06s]
[0m17:40:56.676278 [warn ] [Thread-2 (]: 9 of 10 WARN 2 unique_chw_activity_monthly_chv_id .............................. [[33mWARN 2[0m in 0.03s]
[0m17:40:56.676558 [debug] [Thread-1 (]: Finished running node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m17:40:56.676844 [debug] [Thread-2 (]: Finished running node test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f
[0m17:40:56.677607 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:56.677785 [debug] [MainThread]: On master: BEGIN
[0m17:40:56.677922 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:56.690010 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:40:56.690293 [debug] [MainThread]: On master: COMMIT
[0m17:40:56.690462 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:56.690612 [debug] [MainThread]: On master: COMMIT
[0m17:40:56.690878 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:40:56.691029 [debug] [MainThread]: On master: Close
[0m17:40:56.691279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:56.691446 [debug] [MainThread]: Connection 'test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4' was properly closed.
[0m17:40:56.691575 [debug] [MainThread]: Connection 'test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f' was properly closed.
[0m17:40:56.691696 [debug] [MainThread]: Connection 'test.chw_analytics.unique_chw_activity_monthly_chv_id__report_month.626f0482d9' was properly closed.
[0m17:40:56.691813 [debug] [MainThread]: Connection 'test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa' was properly closed.
[0m17:40:56.691977 [info ] [MainThread]: 
[0m17:40:56.692138 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m17:40:56.692825 [debug] [MainThread]: Command end result
[0m17:40:56.706959 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:40:56.707977 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:40:56.711146 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m17:40:56.711313 [info ] [MainThread]: 
[0m17:40:56.711489 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 1 warning:[0m
[0m17:40:56.711634 [info ] [MainThread]: 
[0m17:40:56.711818 [error] [MainThread]: [31mFailure in test dbt_utils_at_least_one_chw_activity_monthly_family_planning_visits (models/starter_code/schema.yml)[0m
[0m17:40:56.712001 [error] [MainThread]:   Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_family_planning_visits (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:56.712147 [info ] [MainThread]: 
[0m17:40:56.712318 [error] [MainThread]: [31mFailure in test dbt_utils_at_least_one_chw_activity_monthly_pregnancy_visits (models/starter_code/schema.yml)[0m
[0m17:40:56.712491 [error] [MainThread]:   Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_pregnancy_visits (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:56.712637 [info ] [MainThread]: 
[0m17:40:56.712796 [error] [MainThread]: [31mFailure in test dbt_utils_at_least_one_chw_activity_monthly_total_activities (models/starter_code/schema.yml)[0m
[0m17:40:56.713149 [error] [MainThread]:   Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_total_activities (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:56.713413 [info ] [MainThread]: 
[0m17:40:56.713629 [error] [MainThread]: [31mFailure in test dbt_utils_at_least_one_chw_activity_monthly_child_assessments (models/starter_code/schema.yml)[0m
[0m17:40:56.713829 [error] [MainThread]:   Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_child_assessments (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:56.713985 [info ] [MainThread]: 
[0m17:40:56.714159 [error] [MainThread]: [31mFailure in test dbt_utils_at_least_one_chw_activity_monthly_unique_households_visited (models/starter_code/schema.yml)[0m
[0m17:40:56.714345 [error] [MainThread]:   Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_unique_households_visited (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:56.714491 [info ] [MainThread]: 
[0m17:40:56.714659 [error] [MainThread]: [31mFailure in test dbt_utils_at_least_one_chw_activity_monthly_unique_patients_served (models/starter_code/schema.yml)[0m
[0m17:40:56.714835 [error] [MainThread]:   Compilation Error in test dbt_utils_at_least_one_chw_activity_monthly_unique_patients_served (models/starter_code/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:56.714972 [info ] [MainThread]: 
[0m17:40:56.715135 [error] [MainThread]: [31mFailure in test unique_chw_activity_monthly_chv_id__report_month (models/starter_code/schema.yml)[0m
[0m17:40:56.715303 [error] [MainThread]:   Compilation Error in test unique_chw_activity_monthly_chv_id__report_month (models/starter_code/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'combination_of_columns'
[0m17:40:56.715444 [info ] [MainThread]: 
[0m17:40:56.715608 [warn ] [MainThread]: [33mWarning in test unique_chw_activity_monthly_chv_id (models/starter_code/schema.yml)[0m
[0m17:40:56.715777 [warn ] [MainThread]: Got 2 results, configured to warn if != 0
[0m17:40:56.715919 [info ] [MainThread]: 
[0m17:40:56.716077 [info ] [MainThread]:   compiled code at target/compiled/chw_analytics/models/starter_code/schema.yml/unique_chw_activity_monthly_chv_id.sql
[0m17:40:56.716221 [info ] [MainThread]: 
[0m17:40:56.716380 [info ] [MainThread]: Done. PASS=2 WARN=1 ERROR=7 SKIP=0 NO-OP=0 TOTAL=10
[0m17:40:56.716675 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:40:56.718650 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.73939455, "process_in_blocks": "0", "process_kernel_time": 0.207091, "process_mem_max_rss": "168869888", "process_out_blocks": "0", "process_user_time": 1.239565}
[0m17:40:56.718872 [debug] [MainThread]: Command `dbt test` failed at 17:40:56.718837 after 0.74 seconds
[0m17:40:56.719068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ec510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f4f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b4fd0>]}
[0m17:40:56.719236 [debug] [MainThread]: Flushing usage events
[0m17:40:57.960835 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:52:51.675435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107361450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b6e10>]}


============================== 17:52:51.678260 | 5ac02477-22be-46f3-a359-e03a707117eb ==============================
[0m17:52:51.678260 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:52:51.678611 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'invocation_command': 'dbt deps', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'fail_fast': 'False', 'log_format': 'default', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'version_check': 'True', 'partial_parse': 'True', 'printer_width': '80', 'warn_error': 'None'}
[0m17:52:51.738954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ac02477-22be-46f3-a359-e03a707117eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107362550>]}
[0m17:52:51.757460 [debug] [MainThread]: Set downloads directory='/var/folders/vq/lk2vwfg5753bswtmgzzgl0dw0000gn/T/dbt-downloads-3eklhyse'
[0m17:52:51.757689 [error] [MainThread]: Encountered an error:
">=1.1.1,<2.0.0" is not a valid semantic version.
[0m17:52:51.759396 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 461, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt/task/deps.py", line 215, in run
    self.lock()
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt/deps/resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt/deps/resolver.py", line 91, in from_contracts
    self.update_from(src)
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt/deps/resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt/deps/registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt/deps/registry.py", line 83, in <listcomp>
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mzaza/Downloads/main_task/.venv/lib/python3.11/site-packages/dbt_common/semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
dbt_common.exceptions.base.SemverError: ">=1.1.1,<2.0.0" is not a valid semantic version.

[0m17:52:51.761306 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.12269567, "process_in_blocks": "0", "process_kernel_time": 0.157629, "process_mem_max_rss": "119947264", "process_out_blocks": "0", "process_user_time": 0.734275}
[0m17:52:51.761564 [debug] [MainThread]: Command `dbt deps` failed at 17:52:51.761521 after 0.12 seconds
[0m17:52:51.761772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10299d010>]}
[0m17:52:51.761952 [debug] [MainThread]: Flushing usage events
[0m17:52:53.073385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:04.667080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d7b50>]}


============================== 17:54:04.670061 | 5cb64943-d9cb-422e-8953-0aee7f633aab ==============================
[0m17:54:04.670061 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:54:04.670387 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'printer_width': '80'}
[0m17:54:04.725962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cb64943-d9cb-422e-8953-0aee7f633aab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dae190>]}
[0m17:54:04.737612 [debug] [MainThread]: Set downloads directory='/var/folders/vq/lk2vwfg5753bswtmgzzgl0dw0000gn/T/dbt-downloads-t0xpe6qr'
[0m17:54:04.737904 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:54:04.797432 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:54:04.798204 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:54:04.906627 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:54:04.918003 [info ] [MainThread]: Updating lock file in file path: /Users/mzaza/Downloads/main_task/package-lock.yml
[0m17:54:04.919890 [debug] [MainThread]: Set downloads directory='/var/folders/vq/lk2vwfg5753bswtmgzzgl0dw0000gn/T/dbt-downloads-vm49jq_d'
[0m17:54:04.922273 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:54:05.585322 [info ] [MainThread]: Installed from version 1.3.2
[0m17:54:05.585639 [info ] [MainThread]: Up to date!
[0m17:54:05.585885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5cb64943-d9cb-422e-8953-0aee7f633aab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f8f90>]}
[0m17:54:05.588395 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9579648, "process_in_blocks": "0", "process_kernel_time": 0.20389, "process_mem_max_rss": "123928576", "process_out_blocks": "0", "process_user_time": 0.78927}
[0m17:54:05.588788 [debug] [MainThread]: Command `dbt deps` succeeded at 17:54:05.588731 after 0.96 seconds
[0m17:54:05.589022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029a1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107353750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107353850>]}
[0m17:54:05.589260 [debug] [MainThread]: Flushing usage events
[0m17:54:06.824932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:27.670063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f02790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f63fd0>]}


============================== 17:54:27.673139 | 7e181697-417d-41fc-bdfa-88f75c9b44a1 ==============================
[0m17:54:27.673139 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:54:27.673499 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt test --select chw_activity_monthly', 'log_format': 'default', 'warn_error': 'None', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'target_path': 'None', 'empty': 'None'}
[0m17:54:27.760616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e181697-417d-41fc-bdfa-88f75c9b44a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d05d0>]}
[0m17:54:27.786986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e181697-417d-41fc-bdfa-88f75c9b44a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057229d0>]}
[0m17:54:27.788309 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:54:27.853913 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:54:27.904185 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:54:27.904551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e181697-417d-41fc-bdfa-88f75c9b44a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e8690>]}
[0m17:54:28.459121 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m17:54:28.459503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7e181697-417d-41fc-bdfa-88f75c9b44a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888d610>]}
[0m17:54:28.569796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e181697-417d-41fc-bdfa-88f75c9b44a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8b550>]}
[0m17:54:28.609278 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:54:28.610439 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:54:28.660042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e181697-417d-41fc-bdfa-88f75c9b44a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a56610>]}
[0m17:54:28.660358 [info ] [MainThread]: Found 2 models, 12 data tests, 1 source, 576 macros
[0m17:54:28.660534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e181697-417d-41fc-bdfa-88f75c9b44a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be9dd0>]}
[0m17:54:28.661509 [info ] [MainThread]: 
[0m17:54:28.661722 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:54:28.661874 [info ] [MainThread]: 
[0m17:54:28.662121 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:54:28.662582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts'
[0m17:54:28.667769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts_metrics'
[0m17:54:28.694092 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:54:28.694343 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:54:28.694557 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m17:54:28.694728 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m17:54:28.694906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:28.695085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:28.725359 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m17:54:28.725609 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m17:54:28.725832 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m17:54:28.726001 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m17:54:28.726186 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m17:54:28.726394 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m17:54:28.734477 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m17:54:28.735155 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m17:54:28.735713 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m17:54:28.736077 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m17:54:28.736640 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m17:54:28.737009 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m17:54:28.739482 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:28.739673 [debug] [MainThread]: On master: BEGIN
[0m17:54:28.739815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:28.749035 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m17:54:28.749203 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:28.749405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:54:28.755382 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m17:54:28.755918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e181697-417d-41fc-bdfa-88f75c9b44a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a56bd0>]}
[0m17:54:28.756158 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:28.756472 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:28.756617 [debug] [MainThread]: On master: BEGIN
[0m17:54:28.756997 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:54:28.757152 [debug] [MainThread]: On master: COMMIT
[0m17:54:28.757294 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:28.757430 [debug] [MainThread]: On master: COMMIT
[0m17:54:28.757691 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:54:28.757835 [debug] [MainThread]: On master: Close
[0m17:54:28.759324 [debug] [Thread-1 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m17:54:28.759540 [info ] [Thread-1 (]: 1 of 10 START test dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0  [RUN]
[0m17:54:28.759755 [debug] [Thread-2 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m17:54:28.760417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2)
[0m17:54:28.760619 [debug] [Thread-3 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m17:54:28.760804 [debug] [Thread-4 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m17:54:28.761008 [info ] [Thread-2 (]: 2 of 10 START test dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0  [RUN]
[0m17:54:28.761216 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m17:54:28.761397 [info ] [Thread-3 (]: 3 of 10 START test dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0  [RUN]
[0m17:54:28.761586 [info ] [Thread-4 (]: 4 of 10 START test dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0  [RUN]
[0m17:54:28.761793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts_metrics, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231)
[0m17:54:28.766383 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m17:54:28.766720 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3'
[0m17:54:28.766970 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803'
[0m17:54:28.767155 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m17:54:28.767413 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m17:54:28.767644 [debug] [Thread-4 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m17:54:28.769914 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m17:54:28.770108 [debug] [Thread-1 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m17:54:28.772202 [debug] [Thread-3 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m17:54:28.774327 [debug] [Thread-4 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m17:54:28.782851 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m17:54:28.783214 [debug] [Thread-2 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m17:54:28.783519 [debug] [Thread-3 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m17:54:28.785099 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m17:54:28.786712 [debug] [Thread-3 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m17:54:28.786945 [debug] [Thread-4 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m17:54:28.787186 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m17:54:28.788713 [debug] [Thread-4 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m17:54:28.789057 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m17:54:28.789248 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: BEGIN
[0m17:54:28.789444 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m17:54:28.789687 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: BEGIN
[0m17:54:28.789903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:28.790120 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: BEGIN
[0m17:54:28.790311 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m17:54:28.790495 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:54:28.790763 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:54:28.790977 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: BEGIN
[0m17:54:28.791360 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:54:28.807479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:54:28.807799 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m17:54:28.808065 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m17:54:28.808308 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(child_assessments >= 0)


  
  
      
    ) dbt_internal_test
[0m17:54:28.808523 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m17:54:28.808671 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m17:54:28.808858 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m17:54:28.809071 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m17:54:28.809236 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m17:54:28.809414 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(pregnancy_visits >= 0)


  
  
      
    ) dbt_internal_test
[0m17:54:28.809606 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(family_planning_visits >= 0)


  
  
      
    ) dbt_internal_test
[0m17:54:28.809797 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(total_activities >= 0)


  
  
      
    ) dbt_internal_test
[0m17:54:28.810528 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:54:28.812682 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: ROLLBACK
[0m17:54:28.812924 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:54:28.813127 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:54:28.813289 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:54:28.813920 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: ROLLBACK
[0m17:54:28.814094 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: Close
[0m17:54:28.814672 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: ROLLBACK
[0m17:54:28.815224 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: ROLLBACK
[0m17:54:28.815577 [info ] [Thread-1 (]: 1 of 10 PASS dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0  [[32mPASS[0m in 0.06s]
[0m17:54:28.815777 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: Close
[0m17:54:28.816087 [debug] [Thread-1 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m17:54:28.816368 [info ] [Thread-2 (]: 2 of 10 PASS dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0  [[32mPASS[0m in 0.05s]
[0m17:54:28.816542 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: Close
[0m17:54:28.816704 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: Close
[0m17:54:28.816912 [debug] [Thread-1 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m17:54:28.817290 [debug] [Thread-2 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m17:54:28.817696 [info ] [Thread-3 (]: 3 of 10 PASS dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0  [[32mPASS[0m in 0.05s]
[0m17:54:28.818034 [info ] [Thread-4 (]: 4 of 10 PASS dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0  [[32mPASS[0m in 0.05s]
[0m17:54:28.818271 [info ] [Thread-1 (]: 5 of 10 START test dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0  [RUN]
[0m17:54:28.818504 [debug] [Thread-2 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m17:54:28.818752 [debug] [Thread-3 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m17:54:28.819018 [debug] [Thread-4 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m17:54:28.819237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052)
[0m17:54:28.819431 [info ] [Thread-2 (]: 6 of 10 START test dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0  [RUN]
[0m17:54:28.819626 [debug] [Thread-3 (]: Began running node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m17:54:28.819799 [debug] [Thread-4 (]: Began running node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m17:54:28.819984 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m17:54:28.820166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb)
[0m17:54:28.820337 [info ] [Thread-3 (]: 7 of 10 START test not_null_chw_activity_monthly_chv_id ........................ [RUN]
[0m17:54:28.823914 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m17:54:28.820498 [info ] [Thread-4 (]: 8 of 10 START test not_null_chw_activity_monthly_report_month .................. [RUN]
[0m17:54:28.824198 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m17:54:28.824395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3, now test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa)
[0m17:54:28.824714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803, now test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4)
[0m17:54:28.827364 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m17:54:28.827707 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m17:54:28.827879 [debug] [Thread-4 (]: Began compiling node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m17:54:28.828043 [debug] [Thread-1 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m17:54:28.831410 [debug] [Thread-3 (]: Writing injected SQL for node "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m17:54:28.833698 [debug] [Thread-4 (]: Writing injected SQL for node "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m17:54:28.835152 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m17:54:28.835464 [debug] [Thread-2 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m17:54:28.836850 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m17:54:28.837116 [debug] [Thread-3 (]: Began executing node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m17:54:28.837376 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m17:54:28.838669 [debug] [Thread-3 (]: Writing runtime sql for node "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m17:54:28.838883 [debug] [Thread-4 (]: Began executing node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m17:54:28.839085 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: BEGIN
[0m17:54:28.839360 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m17:54:28.840696 [debug] [Thread-4 (]: Writing runtime sql for node "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m17:54:28.840960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:28.841168 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: BEGIN
[0m17:54:28.841358 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m17:54:28.841662 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:54:28.841842 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: BEGIN
[0m17:54:28.842018 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m17:54:28.842235 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:54:28.842407 [debug] [Thread-4 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: BEGIN
[0m17:54:28.842633 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:54:28.853644 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m17:54:28.853899 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m17:54:28.854092 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(unique_households_visited >= 0)


  
  
      
    ) dbt_internal_test
[0m17:54:28.855468 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:54:28.856282 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: ROLLBACK
[0m17:54:28.858047 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: Close
[0m17:54:28.858405 [info ] [Thread-1 (]: 5 of 10 PASS dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0  [[32mPASS[0m in 0.04s]
[0m17:54:28.858682 [debug] [Thread-1 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m17:54:28.858883 [debug] [Thread-1 (]: Began running node test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f
[0m17:54:28.859062 [info ] [Thread-1 (]: 9 of 10 START test unique_chw_activity_monthly_chv_id .......................... [RUN]
[0m17:54:28.859282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052, now test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f)
[0m17:54:28.859459 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f
[0m17:54:28.859676 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m17:54:28.859821 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m17:54:28.863065 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"
[0m17:54:28.863324 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m17:54:28.863517 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m17:54:28.863773 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(unique_patients_served >= 0)


  
  
      
    ) dbt_internal_test
[0m17:54:28.863998 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select chv_id
from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where chv_id is null



  
  
      
    ) dbt_internal_test
[0m17:54:28.864202 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m17:54:28.864439 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m17:54:28.864623 [debug] [Thread-4 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select report_month
from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where report_month is null



  
  
      
    ) dbt_internal_test
[0m17:54:28.864827 [debug] [Thread-1 (]: Began executing node test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f
[0m17:54:28.867335 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"
[0m17:54:28.867551 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:54:28.867718 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:54:28.867873 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:54:28.868736 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: ROLLBACK
[0m17:54:28.869416 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: ROLLBACK
[0m17:54:28.870060 [debug] [Thread-4 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: ROLLBACK
[0m17:54:28.870329 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"
[0m17:54:28.870501 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: Close
[0m17:54:28.870659 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: Close
[0m17:54:28.870843 [debug] [Thread-1 (]: On test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f: BEGIN
[0m17:54:28.870990 [debug] [Thread-4 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: Close
[0m17:54:28.871287 [info ] [Thread-2 (]: 6 of 10 PASS dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0  [[32mPASS[0m in 0.05s]
[0m17:54:28.871707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:28.871497 [info ] [Thread-3 (]: 7 of 10 PASS not_null_chw_activity_monthly_chv_id .............................. [[32mPASS[0m in 0.05s]
[0m17:54:28.872246 [debug] [Thread-2 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m17:54:28.872014 [info ] [Thread-4 (]: 8 of 10 PASS not_null_chw_activity_monthly_report_month ........................ [[32mPASS[0m in 0.05s]
[0m17:54:28.872603 [debug] [Thread-3 (]: Finished running node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m17:54:28.872808 [debug] [Thread-2 (]: Began running node test.chw_analytics.unique_chw_activity_monthly_chv_id__report_month.cf3b24a3b6
[0m17:54:28.873079 [debug] [Thread-4 (]: Finished running node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m17:54:28.873321 [info ] [Thread-2 (]: 10 of 10 START test unique_chw_activity_monthly_chv_id__report_month ........... [RUN]
[0m17:54:28.873601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb, now test.chw_analytics.unique_chw_activity_monthly_chv_id__report_month.cf3b24a3b6)
[0m17:54:28.873788 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.unique_chw_activity_monthly_chv_id__report_month.cf3b24a3b6
[0m17:54:28.880985 [debug] [Thread-2 (]: Compilation Error in test unique_chw_activity_monthly_chv_id__report_month (models/starter_code/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'
[0m17:54:28.881451 [error] [Thread-2 (]: 10 of 10 ERROR unique_chw_activity_monthly_chv_id__report_month ................ [[31mERROR[0m in 0.01s]
[0m17:54:28.881777 [debug] [Thread-2 (]: Finished running node test.chw_analytics.unique_chw_activity_monthly_chv_id__report_month.cf3b24a3b6
[0m17:54:28.882029 [debug] [Thread-7 (]: Marking all children of 'test.chw_analytics.unique_chw_activity_monthly_chv_id__report_month.cf3b24a3b6' to be skipped because of status 'error'.  Reason: Compilation Error in test unique_chw_activity_monthly_chv_id__report_month (models/starter_code/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'.
[0m17:54:28.884554 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m17:54:28.884798 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"
[0m17:54:28.885000 [debug] [Thread-1 (]: On test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    chv_id as unique_field,
    count(*) as n_records

from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where chv_id is not null
group by chv_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:54:28.887919 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:54:28.888741 [debug] [Thread-1 (]: On test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f: ROLLBACK
[0m17:54:28.889154 [debug] [Thread-1 (]: On test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f: Close
[0m17:54:28.889589 [warn ] [Thread-1 (]: 9 of 10 WARN 2 unique_chw_activity_monthly_chv_id .............................. [[33mWARN 2[0m in 0.03s]
[0m17:54:28.889890 [debug] [Thread-1 (]: Finished running node test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f
[0m17:54:28.890637 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:28.890842 [debug] [MainThread]: On master: BEGIN
[0m17:54:28.890994 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:28.903304 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:54:28.903593 [debug] [MainThread]: On master: COMMIT
[0m17:54:28.903753 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:28.903890 [debug] [MainThread]: On master: COMMIT
[0m17:54:28.904145 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:54:28.904289 [debug] [MainThread]: On master: Close
[0m17:54:28.904512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:28.904681 [debug] [MainThread]: Connection 'test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f' was properly closed.
[0m17:54:28.904851 [debug] [MainThread]: Connection 'test.chw_analytics.unique_chw_activity_monthly_chv_id__report_month.cf3b24a3b6' was properly closed.
[0m17:54:28.904986 [debug] [MainThread]: Connection 'test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa' was properly closed.
[0m17:54:28.905114 [debug] [MainThread]: Connection 'test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4' was properly closed.
[0m17:54:28.905297 [info ] [MainThread]: 
[0m17:54:28.905460 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m17:54:28.906241 [debug] [MainThread]: Command end result
[0m17:54:28.922693 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m17:54:28.923816 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m17:54:28.927509 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m17:54:28.927696 [info ] [MainThread]: 
[0m17:54:28.927864 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 1 warning:[0m
[0m17:54:28.928010 [info ] [MainThread]: 
[0m17:54:28.928207 [error] [MainThread]: [31mFailure in test unique_chw_activity_monthly_chv_id__report_month (models/starter_code/schema.yml)[0m
[0m17:54:28.928388 [error] [MainThread]:   Compilation Error in test unique_chw_activity_monthly_chv_id__report_month (models/starter_code/schema.yml)
  macro 'dbt_macro__test_unique' takes no keyword argument 'columns'
[0m17:54:28.928527 [info ] [MainThread]: 
[0m17:54:28.928693 [warn ] [MainThread]: [33mWarning in test unique_chw_activity_monthly_chv_id (models/starter_code/schema.yml)[0m
[0m17:54:28.928861 [warn ] [MainThread]: Got 2 results, configured to warn if != 0
[0m17:54:28.928985 [info ] [MainThread]: 
[0m17:54:28.929138 [info ] [MainThread]:   compiled code at target/compiled/chw_analytics/models/starter_code/schema.yml/unique_chw_activity_monthly_chv_id.sql
[0m17:54:28.929281 [info ] [MainThread]: 
[0m17:54:28.929432 [info ] [MainThread]: Done. PASS=8 WARN=1 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m17:54:28.929712 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:54:28.931857 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.3054551, "process_in_blocks": "0", "process_kernel_time": 0.237231, "process_mem_max_rss": "150667264", "process_out_blocks": "0", "process_user_time": 1.789044}
[0m17:54:28.932102 [debug] [MainThread]: Command `dbt test` failed at 17:54:28.932062 after 1.31 seconds
[0m17:54:28.932317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107245bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103559010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e2610>]}
[0m17:54:28.932505 [debug] [MainThread]: Flushing usage events
[0m17:54:31.496483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:57.901921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b759d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b68410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bdbfd0>]}


============================== 18:00:57.904716 | c05a697a-e827-4572-ab62-e11dfbe29f64 ==============================
[0m18:00:57.904716 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:00:57.905076 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'empty': 'None', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt test --select chw_activity_monthly', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/mzaza/Downloads/main_task'}
[0m18:00:57.992659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c05a697a-e827-4572-ab62-e11dfbe29f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c80c90>]}
[0m18:00:58.019858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c05a697a-e827-4572-ab62-e11dfbe29f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b8bd0>]}
[0m18:00:58.021306 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:00:58.086717 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:00:58.159789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:58.160328 [debug] [MainThread]: Partial parsing: updated file: chw_analytics://models/starter_code/schema.yml
[0m18:00:58.344891 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m18:00:58.345252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c05a697a-e827-4572-ab62-e11dfbe29f64', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148b0d90>]}
[0m18:00:58.397758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c05a697a-e827-4572-ab62-e11dfbe29f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c96290>]}
[0m18:00:58.438845 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m18:00:58.440138 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m18:00:58.456154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c05a697a-e827-4572-ab62-e11dfbe29f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114abff10>]}
[0m18:00:58.456443 [info ] [MainThread]: Found 2 models, 12 data tests, 1 source, 576 macros
[0m18:00:58.456621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c05a697a-e827-4572-ab62-e11dfbe29f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139fe8d0>]}
[0m18:00:58.457575 [info ] [MainThread]: 
[0m18:00:58.457767 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:00:58.457908 [info ] [MainThread]: 
[0m18:00:58.458143 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:00:58.458612 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts'
[0m18:00:58.458840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts_metrics'
[0m18:00:58.488550 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m18:00:58.488765 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m18:00:58.488964 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m18:00:58.489119 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m18:00:58.489267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:58.489405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:58.515362 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m18:00:58.515599 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m18:00:58.515808 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m18:00:58.515975 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m18:00:58.516163 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m18:00:58.516363 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m18:00:58.521244 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m18:00:58.521482 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m18:00:58.522207 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m18:00:58.522782 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m18:00:58.523177 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m18:00:58.523346 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m18:00:58.526144 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:58.526355 [debug] [MainThread]: On master: BEGIN
[0m18:00:58.526502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:58.537365 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m18:00:58.537591 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:58.537810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:00:58.543549 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m18:00:58.544176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c05a697a-e827-4572-ab62-e11dfbe29f64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ad09d0>]}
[0m18:00:58.544499 [debug] [MainThread]: On master: ROLLBACK
[0m18:00:58.544824 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:58.544959 [debug] [MainThread]: On master: BEGIN
[0m18:00:58.545420 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:00:58.545574 [debug] [MainThread]: On master: COMMIT
[0m18:00:58.545715 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:58.545850 [debug] [MainThread]: On master: COMMIT
[0m18:00:58.546117 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:00:58.546259 [debug] [MainThread]: On master: Close
[0m18:00:58.547868 [debug] [Thread-1 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:00:58.548076 [debug] [Thread-2 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:00:58.548382 [debug] [Thread-3 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:00:58.548761 [debug] [Thread-4 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:00:58.548588 [info ] [Thread-1 (]: 1 of 10 START test dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0  [RUN]
[0m18:00:58.549004 [info ] [Thread-2 (]: 2 of 10 START test dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0  [RUN]
[0m18:00:58.549298 [info ] [Thread-3 (]: 3 of 10 START test dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0  [RUN]
[0m18:00:58.549547 [info ] [Thread-4 (]: 4 of 10 START test dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0  [RUN]
[0m18:00:58.549815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2)
[0m18:00:58.550061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts_metrics, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231)
[0m18:00:58.550305 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3'
[0m18:00:58.550530 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803'
[0m18:00:58.550708 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:00:58.550879 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:00:58.551043 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:00:58.551215 [debug] [Thread-4 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:00:58.555908 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:00:58.558189 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:00:58.560179 [debug] [Thread-3 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:00:58.562254 [debug] [Thread-4 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:00:58.562773 [debug] [Thread-3 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:00:58.568916 [debug] [Thread-2 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:00:58.569131 [debug] [Thread-1 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:00:58.571096 [debug] [Thread-3 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:00:58.573176 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:00:58.574402 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:00:58.574575 [debug] [Thread-4 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:00:58.575011 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:00:58.576232 [debug] [Thread-4 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:00:58.576478 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:00:58.576687 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: BEGIN
[0m18:00:58.576874 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:00:58.577111 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: BEGIN
[0m18:00:58.577308 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:00:58.577493 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: BEGIN
[0m18:00:58.577673 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:00:58.577838 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:58.578082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:58.578255 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: BEGIN
[0m18:00:58.578538 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:00:58.597783 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m18:00:58.598080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m18:00:58.598258 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m18:00:58.598464 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:00:58.598620 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m18:00:58.598785 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:00:58.598950 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:00:58.599134 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(pregnancy_visits >= 0)


  
  
      
    ) dbt_internal_test
[0m18:00:58.599313 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:00:58.599488 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(child_assessments >= 0)


  
  
      
    ) dbt_internal_test
[0m18:00:58.599678 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(family_planning_visits >= 0)


  
  
      
    ) dbt_internal_test
[0m18:00:58.599916 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(total_activities >= 0)


  
  
      
    ) dbt_internal_test
[0m18:00:58.600948 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:00:58.603001 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: ROLLBACK
[0m18:00:58.603229 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:00:58.603450 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:00:58.603622 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:00:58.604252 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: ROLLBACK
[0m18:00:58.604498 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: Close
[0m18:00:58.605862 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: ROLLBACK
[0m18:00:58.606668 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: ROLLBACK
[0m18:00:58.607109 [info ] [Thread-1 (]: 1 of 10 PASS dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0  [[32mPASS[0m in 0.06s]
[0m18:00:58.607517 [debug] [Thread-1 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:00:58.607742 [debug] [Thread-1 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:00:58.607939 [info ] [Thread-1 (]: 5 of 10 START test dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0  [RUN]
[0m18:00:58.608172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052)
[0m18:00:58.608406 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:00:58.608645 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: Close
[0m18:00:58.611185 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:00:58.611428 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: Close
[0m18:00:58.611668 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: Close
[0m18:00:58.612044 [info ] [Thread-2 (]: 2 of 10 PASS dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0  [[32mPASS[0m in 0.06s]
[0m18:00:58.612506 [info ] [Thread-4 (]: 4 of 10 PASS dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0  [[32mPASS[0m in 0.06s]
[0m18:00:58.612890 [info ] [Thread-3 (]: 3 of 10 PASS dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0  [[32mPASS[0m in 0.06s]
[0m18:00:58.613252 [debug] [Thread-2 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:00:58.613483 [debug] [Thread-1 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:00:58.613755 [debug] [Thread-4 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:00:58.614019 [debug] [Thread-3 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:00:58.614233 [debug] [Thread-2 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:00:58.615741 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:00:58.616022 [debug] [Thread-4 (]: Began running node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:00:58.616296 [debug] [Thread-3 (]: Began running node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:00:58.616554 [info ] [Thread-2 (]: 6 of 10 START test dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0  [RUN]
[0m18:00:58.616829 [info ] [Thread-4 (]: 7 of 10 START test dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month  [RUN]
[0m18:00:58.617090 [info ] [Thread-3 (]: 8 of 10 START test not_null_chw_activity_monthly_chv_id ........................ [RUN]
[0m18:00:58.617403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb)
[0m18:00:58.617636 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:00:58.617848 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803, now test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48)
[0m18:00:58.618061 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3, now test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa)
[0m18:00:58.618262 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:00:58.618451 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: BEGIN
[0m18:00:58.618627 [debug] [Thread-4 (]: Began compiling node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:00:58.618800 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:00:58.621164 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:00:58.621465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:58.623689 [debug] [Thread-4 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:00:58.626764 [debug] [Thread-3 (]: Writing injected SQL for node "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:00:58.627367 [debug] [Thread-2 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:00:58.627702 [debug] [Thread-3 (]: Began executing node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:00:58.629243 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:00:58.629446 [debug] [Thread-4 (]: Began executing node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:00:58.631975 [debug] [Thread-3 (]: Writing runtime sql for node "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:00:58.633558 [debug] [Thread-4 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:00:58.633990 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:00:58.634287 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: BEGIN
[0m18:00:58.634505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:58.634734 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:00:58.634997 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:00:58.635326 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: BEGIN
[0m18:00:58.635529 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: BEGIN
[0m18:00:58.635742 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:58.635949 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:58.639595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:00:58.639825 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:00:58.640025 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(unique_households_visited >= 0)


  
  
      
    ) dbt_internal_test
[0m18:00:58.643715 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:00:58.644595 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: ROLLBACK
[0m18:00:58.644957 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: Close
[0m18:00:58.645301 [info ] [Thread-1 (]: 5 of 10 PASS dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0  [[32mPASS[0m in 0.04s]
[0m18:00:58.645588 [debug] [Thread-1 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:00:58.645797 [debug] [Thread-1 (]: Began running node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:00:58.646028 [info ] [Thread-1 (]: 9 of 10 START test not_null_chw_activity_monthly_report_month .................. [RUN]
[0m18:00:58.646236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052, now test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4)
[0m18:00:58.646410 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:00:58.648703 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:00:58.649230 [debug] [Thread-1 (]: Began executing node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:00:58.650570 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:00:58.650797 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m18:00:58.651016 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m18:00:58.651183 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m18:00:58.651406 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:00:58.651616 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:00:58.651822 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:00:58.652006 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:00:58.652200 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(unique_patients_served >= 0)


  
  
      
    ) dbt_internal_test
[0m18:00:58.652429 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        chv_id, report_month
    from "chw_analytics"."marts_metrics"."chw_activity_monthly"
    group by chv_id, report_month
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:00:58.652635 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select chv_id
from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where chv_id is null



  
  
      
    ) dbt_internal_test
[0m18:00:58.652817 [debug] [Thread-1 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: BEGIN
[0m18:00:58.653081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:58.655808 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:00:58.656665 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: ROLLBACK
[0m18:00:58.656873 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:00:58.657048 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:00:58.657719 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: ROLLBACK
[0m18:00:58.658288 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: ROLLBACK
[0m18:00:58.658467 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: Close
[0m18:00:58.658842 [info ] [Thread-2 (]: 6 of 10 PASS dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0  [[32mPASS[0m in 0.04s]
[0m18:00:58.659107 [debug] [Thread-2 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:00:58.659299 [debug] [Thread-2 (]: Began running node test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f
[0m18:00:58.659503 [info ] [Thread-2 (]: 10 of 10 START test unique_chw_activity_monthly_chv_id ......................... [RUN]
[0m18:00:58.659704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb, now test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f)
[0m18:00:58.659879 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f
[0m18:00:58.663368 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"
[0m18:00:58.663609 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: Close
[0m18:00:58.663779 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: Close
[0m18:00:58.664133 [info ] [Thread-4 (]: 7 of 10 PASS dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month  [[32mPASS[0m in 0.05s]
[0m18:00:58.664368 [info ] [Thread-3 (]: 8 of 10 PASS not_null_chw_activity_monthly_chv_id .............................. [[32mPASS[0m in 0.05s]
[0m18:00:58.664707 [debug] [Thread-4 (]: Finished running node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:00:58.664951 [debug] [Thread-3 (]: Finished running node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:00:58.665116 [debug] [Thread-2 (]: Began executing node test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f
[0m18:00:58.666596 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"
[0m18:00:58.666999 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"
[0m18:00:58.667176 [debug] [Thread-2 (]: On test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f: BEGIN
[0m18:00:58.667333 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:58.674512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m18:00:58.674754 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m18:00:58.674967 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:00:58.675170 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"
[0m18:00:58.675387 [debug] [Thread-1 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select report_month
from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where report_month is null



  
  
      
    ) dbt_internal_test
[0m18:00:58.675589 [debug] [Thread-2 (]: On test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    chv_id as unique_field,
    count(*) as n_records

from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where chv_id is not null
group by chv_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:00:58.676285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:00:58.676452 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:00:58.677206 [debug] [Thread-1 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: ROLLBACK
[0m18:00:58.677841 [debug] [Thread-2 (]: On test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f: ROLLBACK
[0m18:00:58.678156 [debug] [Thread-1 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: Close
[0m18:00:58.678310 [debug] [Thread-2 (]: On test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f: Close
[0m18:00:58.678609 [info ] [Thread-1 (]: 9 of 10 PASS not_null_chw_activity_monthly_report_month ........................ [[32mPASS[0m in 0.03s]
[0m18:00:58.678890 [warn ] [Thread-2 (]: 10 of 10 WARN 2 unique_chw_activity_monthly_chv_id ............................. [[33mWARN 2[0m in 0.02s]
[0m18:00:58.679190 [debug] [Thread-1 (]: Finished running node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:00:58.679433 [debug] [Thread-2 (]: Finished running node test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f
[0m18:00:58.680125 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:58.680281 [debug] [MainThread]: On master: BEGIN
[0m18:00:58.680414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:58.689454 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:00:58.689721 [debug] [MainThread]: On master: COMMIT
[0m18:00:58.689890 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:58.690153 [debug] [MainThread]: On master: COMMIT
[0m18:00:58.690590 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:00:58.690795 [debug] [MainThread]: On master: Close
[0m18:00:58.691007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:58.691143 [debug] [MainThread]: Connection 'test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4' was properly closed.
[0m18:00:58.691264 [debug] [MainThread]: Connection 'test.chw_analytics.unique_chw_activity_monthly_chv_id.5000fe981f' was properly closed.
[0m18:00:58.691382 [debug] [MainThread]: Connection 'test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa' was properly closed.
[0m18:00:58.691497 [debug] [MainThread]: Connection 'test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48' was properly closed.
[0m18:00:58.691663 [info ] [MainThread]: 
[0m18:00:58.691818 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:00:58.692550 [debug] [MainThread]: Command end result
[0m18:00:58.710135 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m18:00:58.711190 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m18:00:58.714846 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m18:00:58.715032 [info ] [MainThread]: 
[0m18:00:58.715209 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m18:00:58.715352 [info ] [MainThread]: 
[0m18:00:58.715527 [warn ] [MainThread]: [33mWarning in test unique_chw_activity_monthly_chv_id (models/starter_code/schema.yml)[0m
[0m18:00:58.715691 [warn ] [MainThread]: Got 2 results, configured to warn if != 0
[0m18:00:58.715814 [info ] [MainThread]: 
[0m18:00:58.715965 [info ] [MainThread]:   compiled code at target/compiled/chw_analytics/models/starter_code/schema.yml/unique_chw_activity_monthly_chv_id.sql
[0m18:00:58.716101 [info ] [MainThread]: 
[0m18:00:58.716237 [info ] [MainThread]: Done. PASS=9 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m18:00:58.716496 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:00:58.718764 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.853183, "process_in_blocks": "0", "process_kernel_time": 0.235089, "process_mem_max_rss": "148570112", "process_out_blocks": "0", "process_user_time": 1.347622}
[0m18:00:58.719121 [debug] [MainThread]: Command `dbt test` succeeded at 18:00:58.719072 after 0.85 seconds
[0m18:00:58.719343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bffd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129166d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d61190>]}
[0m18:00:58.719562 [debug] [MainThread]: Flushing usage events
[0m18:00:59.954710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:47.573744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ab350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aedbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b13fd0>]}


============================== 18:01:47.576228 | fdec7dcd-5947-4b4d-980c-1cff4f0285eb ==============================
[0m18:01:47.576228 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:01:47.576544 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'None', 'invocation_command': 'dbt test --select chw_activity_monthly', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'fail_fast': 'False'}
[0m18:01:47.655757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdec7dcd-5947-4b4d-980c-1cff4f0285eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d6e90>]}
[0m18:01:47.682996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdec7dcd-5947-4b4d-980c-1cff4f0285eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061af750>]}
[0m18:01:47.683522 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:01:47.743837 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:01:47.807525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:01:47.808048 [debug] [MainThread]: Partial parsing: updated file: chw_analytics://models/starter_code/schema.yml
[0m18:01:47.990075 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m18:01:47.990425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fdec7dcd-5947-4b4d-980c-1cff4f0285eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d2c90>]}
[0m18:01:48.043478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdec7dcd-5947-4b4d-980c-1cff4f0285eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a1350>]}
[0m18:01:48.087237 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m18:01:48.088434 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m18:01:48.100425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdec7dcd-5947-4b4d-980c-1cff4f0285eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106925750>]}
[0m18:01:48.100735 [info ] [MainThread]: Found 2 models, 11 data tests, 1 source, 576 macros
[0m18:01:48.100911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdec7dcd-5947-4b4d-980c-1cff4f0285eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f8bd0>]}
[0m18:01:48.101867 [info ] [MainThread]: 
[0m18:01:48.102066 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:01:48.102210 [info ] [MainThread]: 
[0m18:01:48.102453 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:01:48.102952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts_metrics'
[0m18:01:48.103213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts'
[0m18:01:48.127361 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m18:01:48.127611 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m18:01:48.127777 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m18:01:48.127937 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m18:01:48.128079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:48.128215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:48.150626 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m18:01:48.150887 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m18:01:48.151074 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m18:01:48.151264 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m18:01:48.151431 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m18:01:48.151599 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m18:01:48.158846 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m18:01:48.159130 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m18:01:48.159846 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m18:01:48.160387 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m18:01:48.160809 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m18:01:48.161051 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m18:01:48.164084 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:48.164316 [debug] [MainThread]: On master: BEGIN
[0m18:01:48.164469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:48.178919 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m18:01:48.179185 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:48.179398 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:01:48.183700 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m18:01:48.184338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdec7dcd-5947-4b4d-980c-1cff4f0285eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061bf510>]}
[0m18:01:48.184598 [debug] [MainThread]: On master: ROLLBACK
[0m18:01:48.184894 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:48.185030 [debug] [MainThread]: On master: BEGIN
[0m18:01:48.185380 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:01:48.185520 [debug] [MainThread]: On master: COMMIT
[0m18:01:48.185654 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:48.185778 [debug] [MainThread]: On master: COMMIT
[0m18:01:48.186124 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:01:48.186271 [debug] [MainThread]: On master: Close
[0m18:01:48.187503 [debug] [Thread-1 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:01:48.187740 [debug] [Thread-2 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:01:48.187927 [info ] [Thread-1 (]: 1 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0  [RUN]
[0m18:01:48.188127 [info ] [Thread-2 (]: 2 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0  [RUN]
[0m18:01:48.188426 [debug] [Thread-3 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:01:48.188611 [debug] [Thread-4 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:01:48.188878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts_metrics, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2)
[0m18:01:48.189086 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231)
[0m18:01:48.189277 [info ] [Thread-3 (]: 3 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0  [RUN]
[0m18:01:48.189480 [info ] [Thread-4 (]: 4 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0  [RUN]
[0m18:01:48.189729 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:01:48.189946 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:01:48.190199 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3'
[0m18:01:48.190422 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803'
[0m18:01:48.195057 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:01:48.197224 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:01:48.197477 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:01:48.197662 [debug] [Thread-4 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:01:48.199916 [debug] [Thread-3 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:01:48.202110 [debug] [Thread-4 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:01:48.202472 [debug] [Thread-1 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:01:48.208942 [debug] [Thread-3 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:01:48.212329 [debug] [Thread-3 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:01:48.212551 [debug] [Thread-2 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:01:48.213385 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:01:48.214660 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:01:48.214963 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:01:48.215164 [debug] [Thread-4 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:01:48.215383 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: BEGIN
[0m18:01:48.215627 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:01:48.215802 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:01:48.216930 [debug] [Thread-4 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:01:48.217109 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:01:48.217276 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: BEGIN
[0m18:01:48.217434 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: BEGIN
[0m18:01:48.217736 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:48.217924 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:01:48.218101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:48.218345 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: BEGIN
[0m18:01:48.218572 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:01:48.230709 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m18:01:48.230905 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:01:48.231088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m18:01:48.231268 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(pregnancy_visits >= 0)


  
  
      
    ) dbt_internal_test
[0m18:01:48.231467 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:01:48.231679 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(child_assessments >= 0)


  
  
      
    ) dbt_internal_test
[0m18:01:48.232968 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:01:48.234973 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: ROLLBACK
[0m18:01:48.235185 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:01:48.235383 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m18:01:48.236024 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: ROLLBACK
[0m18:01:48.236191 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: Close
[0m18:01:48.236350 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m18:01:48.236529 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:01:48.236869 [info ] [Thread-3 (]: 3 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0  [[32mPASS[0m in 0.05s]
[0m18:01:48.237054 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: Close
[0m18:01:48.237227 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:01:48.237417 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(family_planning_visits >= 0)


  
  
      
    ) dbt_internal_test
[0m18:01:48.237679 [debug] [Thread-3 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:01:48.237960 [info ] [Thread-1 (]: 1 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0  [[32mPASS[0m in 0.05s]
[0m18:01:48.238217 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(total_activities >= 0)


  
  
      
    ) dbt_internal_test
[0m18:01:48.238508 [debug] [Thread-3 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:01:48.238783 [debug] [Thread-1 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:01:48.239041 [info ] [Thread-3 (]: 5 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0  [RUN]
[0m18:01:48.239260 [debug] [Thread-1 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:01:48.239462 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052)
[0m18:01:48.239660 [info ] [Thread-1 (]: 6 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0  [RUN]
[0m18:01:48.239856 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:01:48.240051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb)
[0m18:01:48.242398 [debug] [Thread-3 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:01:48.242616 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:01:48.242775 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:01:48.242930 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:01:48.243702 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: ROLLBACK
[0m18:01:48.244321 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: ROLLBACK
[0m18:01:48.246542 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:01:48.246815 [debug] [Thread-3 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:01:48.248210 [debug] [Thread-3 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:01:48.248411 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: Close
[0m18:01:48.248572 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: Close
[0m18:01:48.249102 [debug] [Thread-1 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:01:48.248943 [info ] [Thread-2 (]: 2 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0  [[32mPASS[0m in 0.06s]
[0m18:01:48.250570 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:01:48.250853 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:01:48.251150 [info ] [Thread-4 (]: 4 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0  [[32mPASS[0m in 0.06s]
[0m18:01:48.251472 [debug] [Thread-2 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:01:48.251745 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: BEGIN
[0m18:01:48.252032 [debug] [Thread-4 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:01:48.252258 [debug] [Thread-2 (]: Began running node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:01:48.252503 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:01:48.252690 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:48.252886 [debug] [Thread-4 (]: Began running node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:01:48.253097 [info ] [Thread-2 (]: 7 of 9 START test dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month  [RUN]
[0m18:01:48.253296 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: BEGIN
[0m18:01:48.253559 [info ] [Thread-4 (]: 8 of 9 START test not_null_chw_activity_monthly_chv_id ......................... [RUN]
[0m18:01:48.253829 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231, now test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48)
[0m18:01:48.254037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:48.254223 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803, now test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa)
[0m18:01:48.254419 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:01:48.254680 [debug] [Thread-4 (]: Began compiling node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:01:48.257180 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:01:48.260860 [debug] [Thread-4 (]: Writing injected SQL for node "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:01:48.261489 [debug] [Thread-2 (]: Began executing node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:01:48.262973 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:01:48.263240 [debug] [Thread-4 (]: Began executing node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:01:48.265982 [debug] [Thread-4 (]: Writing runtime sql for node "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:01:48.266489 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:01:48.266758 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: BEGIN
[0m18:01:48.266970 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m18:01:48.267146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m18:01:48.267347 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:01:48.267554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:48.267757 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:01:48.267949 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:01:48.268194 [debug] [Thread-4 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: BEGIN
[0m18:01:48.268559 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(unique_households_visited >= 0)


  
  
      
    ) dbt_internal_test
[0m18:01:48.268806 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(unique_patients_served >= 0)


  
  
      
    ) dbt_internal_test
[0m18:01:48.269020 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:48.270487 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:01:48.270690 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:01:48.271537 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: ROLLBACK
[0m18:01:48.272223 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: ROLLBACK
[0m18:01:48.273886 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: Close
[0m18:01:48.274398 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: Close
[0m18:01:48.274235 [info ] [Thread-1 (]: 6 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0  [[32mPASS[0m in 0.03s]
[0m18:01:48.274972 [debug] [Thread-1 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:01:48.274752 [info ] [Thread-3 (]: 5 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0  [[32mPASS[0m in 0.04s]
[0m18:01:48.275224 [debug] [Thread-1 (]: Began running node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:01:48.275497 [debug] [Thread-3 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:01:48.275689 [info ] [Thread-1 (]: 9 of 9 START test not_null_chw_activity_monthly_report_month ................... [RUN]
[0m18:01:48.275987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb, now test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4)
[0m18:01:48.276188 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:01:48.278612 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:01:48.279042 [debug] [Thread-1 (]: Began executing node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:01:48.280265 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:01:48.280766 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:01:48.280997 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m18:01:48.281198 [debug] [Thread-1 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: BEGIN
[0m18:01:48.281390 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:01:48.281565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:48.281834 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        chv_id, report_month
    from "chw_analytics"."marts_metrics"."chw_activity_monthly"
    group by chv_id, report_month
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:01:48.286360 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:01:48.287276 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: ROLLBACK
[0m18:01:48.287480 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m18:01:48.287697 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:01:48.287869 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: Close
[0m18:01:48.288079 [debug] [Thread-4 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select chv_id
from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where chv_id is null



  
  
      
    ) dbt_internal_test
[0m18:01:48.288442 [info ] [Thread-2 (]: 7 of 9 PASS dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month  [[32mPASS[0m in 0.03s]
[0m18:01:48.288831 [debug] [Thread-2 (]: Finished running node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:01:48.291391 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:01:48.292259 [debug] [Thread-4 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: ROLLBACK
[0m18:01:48.292864 [debug] [Thread-4 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: Close
[0m18:01:48.293176 [info ] [Thread-4 (]: 8 of 9 PASS not_null_chw_activity_monthly_chv_id ............................... [[32mPASS[0m in 0.04s]
[0m18:01:48.293447 [debug] [Thread-4 (]: Finished running node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:01:48.296439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m18:01:48.296662 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:01:48.296854 [debug] [Thread-1 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select report_month
from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where report_month is null



  
  
      
    ) dbt_internal_test
[0m18:01:48.298604 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:01:48.299278 [debug] [Thread-1 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: ROLLBACK
[0m18:01:48.299670 [debug] [Thread-1 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: Close
[0m18:01:48.299943 [info ] [Thread-1 (]: 9 of 9 PASS not_null_chw_activity_monthly_report_month ......................... [[32mPASS[0m in 0.02s]
[0m18:01:48.300189 [debug] [Thread-1 (]: Finished running node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:01:48.300843 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:48.300997 [debug] [MainThread]: On master: BEGIN
[0m18:01:48.301124 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:48.379385 [debug] [MainThread]: SQL status: BEGIN in 0.078 seconds
[0m18:01:48.379659 [debug] [MainThread]: On master: COMMIT
[0m18:01:48.379814 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:48.379950 [debug] [MainThread]: On master: COMMIT
[0m18:01:48.380213 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:01:48.380356 [debug] [MainThread]: On master: Close
[0m18:01:48.380569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:48.380703 [debug] [MainThread]: Connection 'test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4' was properly closed.
[0m18:01:48.380827 [debug] [MainThread]: Connection 'test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48' was properly closed.
[0m18:01:48.380948 [debug] [MainThread]: Connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052' was properly closed.
[0m18:01:48.381067 [debug] [MainThread]: Connection 'test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa' was properly closed.
[0m18:01:48.381241 [info ] [MainThread]: 
[0m18:01:48.381401 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m18:01:48.382113 [debug] [MainThread]: Command end result
[0m18:01:48.397689 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m18:01:48.398724 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m18:01:48.402488 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m18:01:48.402739 [info ] [MainThread]: 
[0m18:01:48.402940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:48.403100 [info ] [MainThread]: 
[0m18:01:48.403351 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m18:01:48.403682 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:01:48.405248 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8679188, "process_in_blocks": "0", "process_kernel_time": 0.189118, "process_mem_max_rss": "150142976", "process_out_blocks": "0", "process_user_time": 1.316839}
[0m18:01:48.405491 [debug] [MainThread]: Command `dbt test` succeeded at 18:01:48.405452 after 0.87 seconds
[0m18:01:48.405685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010f9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8b5d0>]}
[0m18:01:48.405870 [debug] [MainThread]: Flushing usage events
[0m18:01:49.622092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:11:32.914868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107540710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107542e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107557fd0>]}


============================== 18:11:32.917900 | 13731578-d2b3-49b9-973a-0629c886bb2f ==============================
[0m18:11:32.917900 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:11:32.918238 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/mzaza/Downloads/main_task/logs', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'static_parser': 'True', 'no_print': 'None', 'empty': 'None', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test --select chw_activity_monthly', 'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True'}
[0m18:11:33.013689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13731578-d2b3-49b9-973a-0629c886bb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0af10>]}
[0m18:11:33.040982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13731578-d2b3-49b9-973a-0629c886bb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b53750>]}
[0m18:11:33.041709 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:11:33.107456 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:11:33.180608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:11:33.180906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:11:33.203543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13731578-d2b3-49b9-973a-0629c886bb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce74d0>]}
[0m18:11:33.246123 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m18:11:33.247573 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m18:11:33.264345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13731578-d2b3-49b9-973a-0629c886bb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108109110>]}
[0m18:11:33.264675 [info ] [MainThread]: Found 2 models, 11 data tests, 1 source, 576 macros
[0m18:11:33.264857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13731578-d2b3-49b9-973a-0629c886bb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107543cd0>]}
[0m18:11:33.265852 [info ] [MainThread]: 
[0m18:11:33.266049 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:11:33.266191 [info ] [MainThread]: 
[0m18:11:33.266465 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:11:33.267066 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts'
[0m18:11:33.267322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts_metrics'
[0m18:11:33.340922 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m18:11:33.341144 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m18:11:33.341357 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m18:11:33.341514 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m18:11:33.341678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:33.341815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:33.370791 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m18:11:33.371047 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m18:11:33.371258 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m18:11:33.371462 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m18:11:33.371720 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m18:11:33.371949 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m18:11:33.383473 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m18:11:33.384327 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m18:11:33.384799 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m18:11:33.385119 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m18:11:33.385899 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m18:11:33.386295 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m18:11:33.388985 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:33.389226 [debug] [MainThread]: On master: BEGIN
[0m18:11:33.389372 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:33.398272 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:11:33.398544 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:33.398767 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:11:33.403675 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m18:11:33.404306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13731578-d2b3-49b9-973a-0629c886bb2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108101b50>]}
[0m18:11:33.404559 [debug] [MainThread]: On master: ROLLBACK
[0m18:11:33.404972 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:33.405122 [debug] [MainThread]: On master: BEGIN
[0m18:11:33.405649 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:11:33.405790 [debug] [MainThread]: On master: COMMIT
[0m18:11:33.405931 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:33.406068 [debug] [MainThread]: On master: COMMIT
[0m18:11:33.406363 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:11:33.406496 [debug] [MainThread]: On master: Close
[0m18:11:33.408061 [debug] [Thread-1 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:11:33.408262 [debug] [Thread-2 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:11:33.408476 [debug] [Thread-3 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:11:33.408745 [debug] [Thread-4 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:11:33.408932 [info ] [Thread-1 (]: 1 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0  [RUN]
[0m18:11:33.409147 [info ] [Thread-2 (]: 2 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0  [RUN]
[0m18:11:33.409352 [info ] [Thread-3 (]: 3 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0  [RUN]
[0m18:11:33.409553 [info ] [Thread-4 (]: 4 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0  [RUN]
[0m18:11:33.409784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2)
[0m18:11:33.409998 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts_metrics, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231)
[0m18:11:33.410229 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3'
[0m18:11:33.410444 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803'
[0m18:11:33.410617 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:11:33.410791 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:11:33.410954 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:11:33.411109 [debug] [Thread-4 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:11:33.420013 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:11:33.422239 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:11:33.424380 [debug] [Thread-3 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:11:33.426421 [debug] [Thread-4 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:11:33.427264 [debug] [Thread-2 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:11:33.427523 [debug] [Thread-4 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:11:33.427729 [debug] [Thread-3 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:11:33.427894 [debug] [Thread-1 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:11:33.436262 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:11:33.438586 [debug] [Thread-4 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:11:33.439895 [debug] [Thread-3 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:11:33.441134 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:11:33.441717 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:11:33.441943 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:11:33.442148 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:11:33.442337 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:11:33.442516 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: BEGIN
[0m18:11:33.442693 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: BEGIN
[0m18:11:33.442859 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: BEGIN
[0m18:11:33.443028 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: BEGIN
[0m18:11:33.443188 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:11:33.443348 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:11:33.443499 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:11:33.443652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:33.460557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m18:11:33.460879 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:11:33.461087 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(child_assessments >= 0)


  
  
      
    ) dbt_internal_test
[0m18:11:33.462195 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m18:11:33.462475 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:11:33.462680 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(pregnancy_visits >= 0)


  
  
      
    ) dbt_internal_test
[0m18:11:33.464277 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:11:33.466578 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: ROLLBACK
[0m18:11:33.466848 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:11:33.467033 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m18:11:33.467890 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: ROLLBACK
[0m18:11:33.468109 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:11:33.468266 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: Close
[0m18:11:33.468425 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m18:11:33.468707 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(total_activities >= 0)


  
  
      
    ) dbt_internal_test
[0m18:11:33.468973 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: Close
[0m18:11:33.469579 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:11:33.469385 [info ] [Thread-1 (]: 1 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0  [[32mPASS[0m in 0.06s]
[0m18:11:33.469987 [info ] [Thread-3 (]: 3 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0  [[32mPASS[0m in 0.06s]
[0m18:11:33.470209 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(family_planning_visits >= 0)


  
  
      
    ) dbt_internal_test
[0m18:11:33.470408 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:11:33.470686 [debug] [Thread-1 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:11:33.470924 [debug] [Thread-3 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:11:33.471761 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: ROLLBACK
[0m18:11:33.472032 [debug] [Thread-1 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:11:33.472229 [debug] [Thread-3 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:11:33.472505 [info ] [Thread-1 (]: 5 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0  [RUN]
[0m18:11:33.472713 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:11:33.472907 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: Close
[0m18:11:33.473095 [info ] [Thread-3 (]: 6 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0  [RUN]
[0m18:11:33.473345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052)
[0m18:11:33.474010 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: ROLLBACK
[0m18:11:33.474293 [info ] [Thread-4 (]: 4 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0  [[32mPASS[0m in 0.06s]
[0m18:11:33.474478 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb)
[0m18:11:33.474675 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:11:33.474943 [debug] [Thread-4 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:11:33.475116 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:11:33.475263 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: Close
[0m18:11:33.477731 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:11:33.478022 [debug] [Thread-4 (]: Began running node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:11:33.480514 [debug] [Thread-3 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:11:33.480938 [info ] [Thread-2 (]: 2 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0  [[32mPASS[0m in 0.07s]
[0m18:11:33.481292 [info ] [Thread-4 (]: 7 of 9 START test dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month  [RUN]
[0m18:11:33.481756 [debug] [Thread-2 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:11:33.482024 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803, now test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48)
[0m18:11:33.482317 [debug] [Thread-2 (]: Began running node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:11:33.482514 [debug] [Thread-1 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:11:33.482709 [debug] [Thread-4 (]: Began compiling node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:11:33.482902 [debug] [Thread-3 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:11:33.483099 [info ] [Thread-2 (]: 8 of 9 START test not_null_chw_activity_monthly_chv_id ......................... [RUN]
[0m18:11:33.484629 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:11:33.490131 [debug] [Thread-4 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:11:33.491606 [debug] [Thread-3 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:11:33.491860 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231, now test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa)
[0m18:11:33.492274 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:11:33.495401 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:11:33.495660 [debug] [Thread-4 (]: Began executing node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:11:33.495947 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:11:33.496216 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:11:33.498757 [debug] [Thread-4 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:11:33.499041 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: BEGIN
[0m18:11:33.499244 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: BEGIN
[0m18:11:33.499416 [debug] [Thread-2 (]: Began executing node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:11:33.499633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:33.499827 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:11:33.501099 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:11:33.501353 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:11:33.501739 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: BEGIN
[0m18:11:33.502015 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:11:33.502251 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:11:33.502517 [debug] [Thread-2 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: BEGIN
[0m18:11:33.502687 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:11:33.516919 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m18:11:33.517166 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:11:33.517363 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(unique_patients_served >= 0)


  
  
      
    ) dbt_internal_test
[0m18:11:33.517584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m18:11:33.517786 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:11:33.517980 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(unique_households_visited >= 0)


  
  
      
    ) dbt_internal_test
[0m18:11:33.518191 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m18:11:33.518354 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:11:33.518532 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        chv_id, report_month
    from "chw_analytics"."marts_metrics"."chw_activity_monthly"
    group by chv_id, report_month
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:11:33.518734 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:11:33.519494 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: ROLLBACK
[0m18:11:33.519687 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m18:11:33.519849 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:11:33.520018 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:11:33.520168 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: Close
[0m18:11:33.520801 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: ROLLBACK
[0m18:11:33.520970 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:11:33.521151 [debug] [Thread-2 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select chv_id
from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where chv_id is null



  
  
      
    ) dbt_internal_test
[0m18:11:33.521528 [info ] [Thread-3 (]: 6 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0  [[32mPASS[0m in 0.05s]
[0m18:11:33.522221 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: ROLLBACK
[0m18:11:33.522446 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: Close
[0m18:11:33.522699 [debug] [Thread-3 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:11:33.523011 [info ] [Thread-1 (]: 5 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0  [[32mPASS[0m in 0.05s]
[0m18:11:33.523233 [debug] [Thread-3 (]: Began running node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:11:33.523513 [debug] [Thread-1 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:11:33.523704 [info ] [Thread-3 (]: 9 of 9 START test not_null_chw_activity_monthly_report_month ................... [RUN]
[0m18:11:33.523948 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb, now test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4)
[0m18:11:33.524124 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:11:33.526360 [debug] [Thread-3 (]: Writing injected SQL for node "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:11:33.526623 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:11:33.526784 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: Close
[0m18:11:33.527535 [debug] [Thread-2 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: ROLLBACK
[0m18:11:33.527900 [info ] [Thread-4 (]: 7 of 9 PASS dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month  [[32mPASS[0m in 0.05s]
[0m18:11:33.528271 [debug] [Thread-4 (]: Finished running node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:11:33.528475 [debug] [Thread-3 (]: Began executing node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:11:33.528667 [debug] [Thread-2 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: Close
[0m18:11:33.530039 [debug] [Thread-3 (]: Writing runtime sql for node "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:11:33.530451 [info ] [Thread-2 (]: 8 of 9 PASS not_null_chw_activity_monthly_chv_id ............................... [[32mPASS[0m in 0.04s]
[0m18:11:33.530744 [debug] [Thread-2 (]: Finished running node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:11:33.531037 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:11:33.531210 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: BEGIN
[0m18:11:33.531364 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:11:33.540713 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m18:11:33.541001 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:11:33.541184 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select report_month
from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where report_month is null



  
  
      
    ) dbt_internal_test
[0m18:11:33.542462 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:11:33.543229 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: ROLLBACK
[0m18:11:33.543598 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: Close
[0m18:11:33.543904 [info ] [Thread-3 (]: 9 of 9 PASS not_null_chw_activity_monthly_report_month ......................... [[32mPASS[0m in 0.02s]
[0m18:11:33.544158 [debug] [Thread-3 (]: Finished running node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:11:33.544797 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:33.544956 [debug] [MainThread]: On master: BEGIN
[0m18:11:33.545084 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:33.558035 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m18:11:33.558319 [debug] [MainThread]: On master: COMMIT
[0m18:11:33.558476 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:33.558614 [debug] [MainThread]: On master: COMMIT
[0m18:11:33.558923 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:11:33.559104 [debug] [MainThread]: On master: Close
[0m18:11:33.559339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:33.559481 [debug] [MainThread]: Connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052' was properly closed.
[0m18:11:33.559609 [debug] [MainThread]: Connection 'test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa' was properly closed.
[0m18:11:33.559757 [debug] [MainThread]: Connection 'test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4' was properly closed.
[0m18:11:33.559939 [debug] [MainThread]: Connection 'test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48' was properly closed.
[0m18:11:33.560138 [info ] [MainThread]: 
[0m18:11:33.560308 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m18:11:33.561057 [debug] [MainThread]: Command end result
[0m18:11:33.577031 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m18:11:33.578054 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m18:11:33.581353 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m18:11:33.581634 [info ] [MainThread]: 
[0m18:11:33.581871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:33.582037 [info ] [MainThread]: 
[0m18:11:33.582200 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m18:11:33.584671 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.70727, "process_in_blocks": "0", "process_kernel_time": 0.237845, "process_mem_max_rss": "143294464", "process_out_blocks": "0", "process_user_time": 1.15965}
[0m18:11:33.584942 [debug] [MainThread]: Command `dbt test` succeeded at 18:11:33.584899 after 0.71 seconds
[0m18:11:33.585156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107557450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107557310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aa5110>]}
[0m18:11:33.585362 [debug] [MainThread]: Flushing usage events
[0m18:11:34.750647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:18:39.887174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e748d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef3f90>]}


============================== 18:18:39.890057 | d829077d-9977-4e69-8485-34c1bdf0d0ee ==============================
[0m18:18:39.890057 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:18:39.890403 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False', 'empty': 'False', 'no_print': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'quiet': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select chw_activity_monthly --full-refresh', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m18:18:39.979951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd829077d-9977-4e69-8485-34c1bdf0d0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2fcd0>]}
[0m18:18:40.007195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd829077d-9977-4e69-8485-34c1bdf0d0ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033e1250>]}
[0m18:18:40.008586 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:18:40.070576 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m18:18:40.073301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.22305779, "process_in_blocks": "0", "process_kernel_time": 0.183162, "process_mem_max_rss": "123666432", "process_out_blocks": "0", "process_user_time": 0.801529}
[0m18:18:40.073730 [debug] [MainThread]: Command `dbt run` failed at 18:18:40.073667 after 0.22 seconds
[0m18:18:40.074029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1013345d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ead290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6bfd0>]}
[0m18:18:40.074283 [debug] [MainThread]: Flushing usage events
[0m18:18:41.309117 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:18:54.394379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a75c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119aef210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119aefad0>]}


============================== 18:18:54.396786 | 63219603-8c51-4db1-93ab-99e3e2e54143 ==============================
[0m18:18:54.396786 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:18:54.397086 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'warn_error': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'log_format': 'default', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager'}
[0m18:18:54.452285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63219603-8c51-4db1-93ab-99e3e2e54143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d8f750>]}
[0m18:18:54.465768 [debug] [MainThread]: Set downloads directory='/var/folders/vq/lk2vwfg5753bswtmgzzgl0dw0000gn/T/dbt-downloads-v8czp_xo'
[0m18:18:54.466002 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:18:54.530791 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:18:54.531691 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:18:54.563020 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:18:54.565566 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:18:55.533312 [info ] [MainThread]: Installed from version 1.3.2
[0m18:18:55.533604 [info ] [MainThread]: Up to date!
[0m18:18:55.533825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '63219603-8c51-4db1-93ab-99e3e2e54143', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11886be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d8e290>]}
[0m18:18:55.536299 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.177499, "process_in_blocks": "0", "process_kernel_time": 0.173337, "process_mem_max_rss": "125288448", "process_out_blocks": "0", "process_user_time": 0.777187}
[0m18:18:55.536580 [debug] [MainThread]: Command `dbt deps` succeeded at 18:18:55.536530 after 1.18 seconds
[0m18:18:55.536773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ad4e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ad4ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a6b7d0>]}
[0m18:18:55.536949 [debug] [MainThread]: Flushing usage events
[0m18:18:56.739461 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:19:00.504795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f74b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fce1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff3fd0>]}


============================== 18:19:00.507338 | de53e13b-571f-4b81-8513-7f6df738b346 ==============================
[0m18:19:00.507338 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:19:00.507656 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'target_path': 'None', 'introspect': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'indirect_selection': 'eager', 'quiet': 'False', 'invocation_command': 'dbt run --select chw_activity_monthly --full-refresh', 'static_parser': 'True', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True'}
[0m18:19:00.596231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de53e13b-571f-4b81-8513-7f6df738b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c6510>]}
[0m18:19:00.623945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de53e13b-571f-4b81-8513-7f6df738b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10951b010>]}
[0m18:19:00.625510 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:19:00.697301 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:19:00.697901 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:19:00.698147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de53e13b-571f-4b81-8513-7f6df738b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10965b9d0>]}
[0m18:19:01.266999 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.expression_is_true`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m18:19:01.267356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de53e13b-571f-4b81-8513-7f6df738b346', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b07c550>]}
[0m18:19:01.381032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de53e13b-571f-4b81-8513-7f6df738b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6aab90>]}
[0m18:19:01.427769 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m18:19:01.429319 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m18:19:01.441020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de53e13b-571f-4b81-8513-7f6df738b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6516d0>]}
[0m18:19:01.441371 [info ] [MainThread]: Found 2 models, 11 data tests, 1 source, 576 macros
[0m18:19:01.441570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de53e13b-571f-4b81-8513-7f6df738b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c142710>]}
[0m18:19:01.442394 [info ] [MainThread]: 
[0m18:19:01.442611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:01.442755 [info ] [MainThread]: 
[0m18:19:01.443010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:19:01.443441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics'
[0m18:19:01.509262 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics"
[0m18:19:01.509541 [debug] [ThreadPool]: On list_chw_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:19:01.509704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:01.538234 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.028 seconds
[0m18:19:01.539058 [debug] [ThreadPool]: On list_chw_analytics: Close
[0m18:19:01.539701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_chw_analytics, now list_chw_analytics_marts)
[0m18:19:01.540043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts_metrics'
[0m18:19:01.542912 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m18:19:01.544082 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m18:19:01.544266 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m18:19:01.544422 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m18:19:01.544557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:01.544691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:01.559822 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m18:19:01.559990 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m18:19:01.560151 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m18:19:01.561828 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m18:19:01.561967 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m18:19:01.562117 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m18:19:01.566257 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m18:19:01.566885 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m18:19:01.567486 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m18:19:01.567642 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m18:19:01.568188 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m18:19:01.569808 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m18:19:01.572127 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:01.572310 [debug] [MainThread]: On master: BEGIN
[0m18:19:01.572455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:01.581742 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:19:01.581956 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:01.582182 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:19:01.587260 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m18:19:01.587866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de53e13b-571f-4b81-8513-7f6df738b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6418d0>]}
[0m18:19:01.588120 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:01.588428 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:01.588582 [debug] [MainThread]: On master: BEGIN
[0m18:19:01.588955 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:19:01.589108 [debug] [MainThread]: On master: COMMIT
[0m18:19:01.589248 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:01.589384 [debug] [MainThread]: On master: COMMIT
[0m18:19:01.589619 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:01.589768 [debug] [MainThread]: On master: Close
[0m18:19:01.591231 [debug] [Thread-1 (]: Began running node model.chw_analytics.chw_activity_monthly
[0m18:19:01.591514 [info ] [Thread-1 (]: 1 of 1 START sql incremental model marts_metrics.chw_activity_monthly .......... [RUN]
[0m18:19:01.591739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts, now model.chw_analytics.chw_activity_monthly)
[0m18:19:01.591919 [debug] [Thread-1 (]: Began compiling node model.chw_analytics.chw_activity_monthly
[0m18:19:01.597558 [debug] [Thread-1 (]: Writing injected SQL for node "model.chw_analytics.chw_activity_monthly"
[0m18:19:01.598264 [debug] [Thread-1 (]: Began executing node model.chw_analytics.chw_activity_monthly
[0m18:19:01.625275 [debug] [Thread-1 (]: Writing runtime sql for node "model.chw_analytics.chw_activity_monthly"
[0m18:19:01.626099 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:01.626297 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: BEGIN
[0m18:19:01.626466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:01.639150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m18:19:01.639407 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:01.639674 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      
  
    

  create  table "chw_analytics"."marts_metrics"."chw_activity_monthly__dbt_tmp"
  
  
    as
  
  (
    /*
Model: chw_activity_monthly
Description: Monthly aggregation of CHW activities for dashboard performance metrics

TODO: Complete this dbt model to aggregate CHW activities by month

Instructions:
1. Add the dbt config block (materialization, unique_key, incremental_strategy)
2. Filter out invalid records (NULL chv_id, NULL activity_date, deleted records)
3. Use the month_assignment macro to calculate report_month
4. Aggregate metrics: total_activities, unique_households_visited, unique_patients_served, pregnancy_visits, child_assessments, family_planning_visits
5. GROUP BY chv_id and report_month
6. Add incremental logic 
*/

-- ============================================
-- dbt Configuration
-- ============================================



-- ============================================
-- Main Query
-- ============================================

with source_data as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        is_deleted,
        created_at,
        updated_at
    from "chw_analytics"."marts"."fct_chv_activity"

    where 1=1
        -- Filter out invalid records as per business requirements
        and chv_id is not null
        and activity_date is not null  
        and is_deleted = false


),

with_report_month as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        -- Use the month_assignment macro to calculate report_month
        


    case 
        -- Activities on/after 26th go to next month
        when extract(day from activity_date) >= 26 then
            date_trunc('month', activity_date + interval '1 month')
        -- Activities before 26th stay in current month  
        else
            date_trunc('month', activity_date)
    end
    

 as report_month

    from source_data

),

aggregated as (

    select
        chv_id,
        report_month,
        -- Calculate all required metrics
        count(*) as total_activities,
        count(distinct household_id) as unique_households_visited,
        count(distinct patient_id) as unique_patients_served,
        count(case when activity_type = 'pregnancy_visit' then 1 end) as pregnancy_visits,
        count(case when activity_type = 'child_assessment' then 1 end) as child_assessments,
        count(case when activity_type = 'family_planning' then 1 end) as family_planning_visits

    from with_report_month
    group by chv_id, report_month

)

-- ============================================
-- Final Select with Incremental Logic
-- ============================================
select * from aggregated


  );
  
  
[0m18:19:01.646463 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:19:01.652999 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:01.653287 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */
alter table "chw_analytics"."marts_metrics"."chw_activity_monthly" rename to "chw_activity_monthly__dbt_backup"
[0m18:19:01.654006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:19:01.655911 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:01.656130 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */
alter table "chw_analytics"."marts_metrics"."chw_activity_monthly__dbt_tmp" rename to "chw_activity_monthly"
[0m18:19:01.657197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:19:01.664733 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: COMMIT
[0m18:19:01.665006 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:01.665176 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: COMMIT
[0m18:19:01.666278 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:19:01.669227 [debug] [Thread-1 (]: Applying DROP to: "chw_analytics"."marts_metrics"."chw_activity_monthly__dbt_backup"
[0m18:19:01.671314 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:01.671519 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */
drop table if exists "chw_analytics"."marts_metrics"."chw_activity_monthly__dbt_backup" cascade
[0m18:19:01.675709 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:19:01.676843 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: Close
[0m18:19:01.677886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de53e13b-571f-4b81-8513-7f6df738b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b7150>]}
[0m18:19:01.678214 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model marts_metrics.chw_activity_monthly ..... [[32mSELECT 6[0m in 0.09s]
[0m18:19:01.678476 [debug] [Thread-1 (]: Finished running node model.chw_analytics.chw_activity_monthly
[0m18:19:01.679096 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:01.679256 [debug] [MainThread]: On master: BEGIN
[0m18:19:01.679390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:01.691836 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m18:19:01.692081 [debug] [MainThread]: On master: COMMIT
[0m18:19:01.692232 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:01.692367 [debug] [MainThread]: On master: COMMIT
[0m18:19:01.692693 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:01.692836 [debug] [MainThread]: On master: Close
[0m18:19:01.693038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:01.693169 [debug] [MainThread]: Connection 'model.chw_analytics.chw_activity_monthly' was properly closed.
[0m18:19:01.693292 [debug] [MainThread]: Connection 'list_chw_analytics_marts_metrics' was properly closed.
[0m18:19:01.693434 [info ] [MainThread]: 
[0m18:19:01.693584 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m18:19:01.693904 [debug] [MainThread]: Command end result
[0m18:19:01.708118 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m18:19:01.709120 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m18:19:01.712001 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m18:19:01.712200 [info ] [MainThread]: 
[0m18:19:01.712438 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:01.712594 [info ] [MainThread]: 
[0m18:19:01.712755 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:19:01.713043 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 7 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:19:01.714917 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2478247, "process_in_blocks": "0", "process_kernel_time": 0.208231, "process_mem_max_rss": "148848640", "process_out_blocks": "0", "process_user_time": 1.674418}
[0m18:19:01.715156 [debug] [MainThread]: Command `dbt run` succeeded at 18:19:01.715116 after 1.25 seconds
[0m18:19:01.715354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10281d1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10281d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6b650>]}
[0m18:19:01.715548 [debug] [MainThread]: Flushing usage events
[0m18:19:02.985624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:19:23.607787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106175990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061cee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f3fd0>]}


============================== 18:19:23.610322 | b58201c9-48c4-42f2-8a48-633ccea96a60 ==============================
[0m18:19:23.610322 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:19:23.610716 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'warn_error': 'None', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'debug': 'False', 'fail_fast': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'invocation_command': 'dbt test --select chw_activity_monthly', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'version_check': 'True'}
[0m18:19:23.689618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b58201c9-48c4-42f2-8a48-633ccea96a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067913d0>]}
[0m18:19:23.716975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b58201c9-48c4-42f2-8a48-633ccea96a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fb8c10>]}
[0m18:19:23.717474 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:19:23.777250 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:19:23.840143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:23.840398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:23.862141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b58201c9-48c4-42f2-8a48-633ccea96a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0c290>]}
[0m18:19:23.905767 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m18:19:23.907035 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m18:19:23.920235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b58201c9-48c4-42f2-8a48-633ccea96a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f856d0>]}
[0m18:19:23.920588 [info ] [MainThread]: Found 2 models, 11 data tests, 1 source, 576 macros
[0m18:19:23.920784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b58201c9-48c4-42f2-8a48-633ccea96a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ed650>]}
[0m18:19:23.921822 [info ] [MainThread]: 
[0m18:19:23.922028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:23.922171 [info ] [MainThread]: 
[0m18:19:23.922462 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:19:23.923117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts_metrics'
[0m18:19:23.929450 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts'
[0m18:19:23.980741 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m18:19:23.980982 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m18:19:23.981138 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m18:19:23.981287 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m18:19:23.981426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:23.981561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:24.009539 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m18:19:24.009815 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m18:19:24.009984 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m18:19:24.010147 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m18:19:24.010319 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m18:19:24.010528 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m18:19:24.022039 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m18:19:24.022946 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m18:19:24.023174 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m18:19:24.023323 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m18:19:24.023885 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m18:19:24.024562 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m18:19:24.027160 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:24.027364 [debug] [MainThread]: On master: BEGIN
[0m18:19:24.027505 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:24.039291 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m18:19:24.039607 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:24.039822 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:19:24.045436 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m18:19:24.046244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b58201c9-48c4-42f2-8a48-633ccea96a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062bb010>]}
[0m18:19:24.046536 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:24.046884 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:24.047050 [debug] [MainThread]: On master: BEGIN
[0m18:19:24.047482 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:19:24.047672 [debug] [MainThread]: On master: COMMIT
[0m18:19:24.047826 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:24.047957 [debug] [MainThread]: On master: COMMIT
[0m18:19:24.048213 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:24.048378 [debug] [MainThread]: On master: Close
[0m18:19:24.049874 [debug] [Thread-1 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:19:24.050124 [debug] [Thread-2 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:19:24.050333 [info ] [Thread-1 (]: 1 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0  [RUN]
[0m18:19:24.050544 [debug] [Thread-3 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:19:24.050846 [debug] [Thread-4 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:19:24.051035 [info ] [Thread-2 (]: 2 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0  [RUN]
[0m18:19:24.051291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts_metrics, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2)
[0m18:19:24.051487 [info ] [Thread-3 (]: 3 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0  [RUN]
[0m18:19:24.051714 [info ] [Thread-4 (]: 4 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0  [RUN]
[0m18:19:24.051908 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231)
[0m18:19:24.052092 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:19:24.052312 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3'
[0m18:19:24.052532 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803'
[0m18:19:24.052714 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:19:24.062254 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:19:24.062491 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:19:24.062680 [debug] [Thread-4 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:19:24.064887 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:19:24.067284 [debug] [Thread-3 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:19:24.069417 [debug] [Thread-4 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:19:24.069934 [debug] [Thread-1 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:19:24.075695 [debug] [Thread-2 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:19:24.079331 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:19:24.079587 [debug] [Thread-3 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:19:24.080192 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:19:24.080407 [debug] [Thread-4 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:19:24.081680 [debug] [Thread-3 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:19:24.083094 [debug] [Thread-4 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:19:24.083388 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:19:24.083713 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:19:24.083949 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: BEGIN
[0m18:19:24.084190 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:19:24.084368 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: BEGIN
[0m18:19:24.084573 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:19:24.084733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:19:24.084905 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: BEGIN
[0m18:19:24.085065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:24.085238 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: BEGIN
[0m18:19:24.085477 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:19:24.085684 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:19:24.097799 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m18:19:24.098037 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"
[0m18:19:24.098215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m18:19:24.098433 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(family_planning_visits >= 0)


  
  
      
    ) dbt_internal_test
[0m18:19:24.098642 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"
[0m18:19:24.098860 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(child_assessments >= 0)


  
  
      
    ) dbt_internal_test
[0m18:19:24.101195 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:19:24.103316 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: ROLLBACK
[0m18:19:24.103528 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m18:19:24.103694 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"
[0m18:19:24.103874 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(total_activities >= 0)


  
  
      
    ) dbt_internal_test
[0m18:19:24.104080 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231: Close
[0m18:19:24.104275 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:19:24.104883 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: ROLLBACK
[0m18:19:24.105250 [info ] [Thread-2 (]: 2 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0  [[32mPASS[0m in 0.05s]
[0m18:19:24.105546 [debug] [Thread-2 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231
[0m18:19:24.105751 [debug] [Thread-2 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:19:24.105932 [info ] [Thread-2 (]: 5 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0  [RUN]
[0m18:19:24.106114 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:19:24.106267 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2: Close
[0m18:19:24.106417 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m18:19:24.106612 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_family_planning_visits___0.36a421b231, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052)
[0m18:19:24.107298 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: ROLLBACK
[0m18:19:24.107516 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"
[0m18:19:24.107759 [info ] [Thread-1 (]: 1 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0  [[32mPASS[0m in 0.06s]
[0m18:19:24.107951 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:19:24.108171 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(pregnancy_visits >= 0)


  
  
      
    ) dbt_internal_test
[0m18:19:24.108424 [debug] [Thread-1 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2
[0m18:19:24.108594 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803: Close
[0m18:19:24.112024 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:19:24.112360 [debug] [Thread-1 (]: Began running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:19:24.112762 [info ] [Thread-4 (]: 4 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0  [[32mPASS[0m in 0.06s]
[0m18:19:24.113028 [info ] [Thread-1 (]: 6 of 9 START test dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0  [RUN]
[0m18:19:24.113340 [debug] [Thread-4 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803
[0m18:19:24.113556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_child_assessments___0.50d05549c2, now test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb)
[0m18:19:24.113741 [debug] [Thread-2 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:19:24.113934 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:19:24.114140 [debug] [Thread-4 (]: Began running node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:19:24.114315 [debug] [Thread-1 (]: Began compiling node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:19:24.115678 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:19:24.116658 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: ROLLBACK
[0m18:19:24.116978 [info ] [Thread-4 (]: 7 of 9 START test dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month  [RUN]
[0m18:19:24.119480 [debug] [Thread-1 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:19:24.119896 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_total_activities___0.4bc7043803, now test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48)
[0m18:19:24.120124 [debug] [Thread-3 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3: Close
[0m18:19:24.120361 [debug] [Thread-4 (]: Began compiling node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:19:24.120570 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:19:24.120805 [debug] [Thread-1 (]: Began executing node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:19:24.126355 [debug] [Thread-4 (]: Writing injected SQL for node "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:19:24.121079 [info ] [Thread-3 (]: 3 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0  [[32mPASS[0m in 0.07s]
[0m18:19:24.126745 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: BEGIN
[0m18:19:24.128240 [debug] [Thread-1 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:19:24.128611 [debug] [Thread-3 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3
[0m18:19:24.128827 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:19:24.129072 [debug] [Thread-4 (]: Began executing node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:19:24.129309 [debug] [Thread-3 (]: Began running node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:19:24.130748 [debug] [Thread-4 (]: Writing runtime sql for node "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:19:24.130981 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:19:24.131214 [info ] [Thread-3 (]: 8 of 9 START test not_null_chw_activity_monthly_chv_id ......................... [RUN]
[0m18:19:24.131532 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: BEGIN
[0m18:19:24.131770 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_pregnancy_visits___0.6f68e117b3, now test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa)
[0m18:19:24.131959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:24.132138 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:19:24.132317 [debug] [Thread-3 (]: Began compiling node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:19:24.132549 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: BEGIN
[0m18:19:24.136148 [debug] [Thread-3 (]: Writing injected SQL for node "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:19:24.136423 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:19:24.136891 [debug] [Thread-3 (]: Began executing node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:19:24.138355 [debug] [Thread-3 (]: Writing runtime sql for node "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:19:24.138789 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:19:24.138971 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: BEGIN
[0m18:19:24.139222 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:19:24.140795 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m18:19:24.141066 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"
[0m18:19:24.141281 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(unique_households_visited >= 0)


  
  
      
    ) dbt_internal_test
[0m18:19:24.146123 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:19:24.146353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m18:19:24.147274 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: ROLLBACK
[0m18:19:24.147516 [debug] [Thread-1 (]: Using postgres connection "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"
[0m18:19:24.147747 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "chw_analytics"."marts_metrics"."chw_activity_monthly"

where not(unique_patients_served >= 0)


  
  
      
    ) dbt_internal_test
[0m18:19:24.147968 [debug] [Thread-2 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052: Close
[0m18:19:24.148383 [info ] [Thread-2 (]: 5 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0  [[32mPASS[0m in 0.04s]
[0m18:19:24.148658 [debug] [Thread-2 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052
[0m18:19:24.148844 [debug] [Thread-2 (]: Began running node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:19:24.149102 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:19:24.149344 [info ] [Thread-2 (]: 9 of 9 START test not_null_chw_activity_monthly_report_month ................... [RUN]
[0m18:19:24.150237 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: ROLLBACK
[0m18:19:24.150540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_households_visited___0.032775e052, now test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4)
[0m18:19:24.150789 [debug] [Thread-2 (]: Began compiling node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:19:24.153021 [debug] [Thread-2 (]: Writing injected SQL for node "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:19:24.153239 [debug] [Thread-1 (]: On test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb: Close
[0m18:19:24.153410 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m18:19:24.153764 [info ] [Thread-1 (]: 6 of 9 PASS dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0  [[32mPASS[0m in 0.04s]
[0m18:19:24.154100 [debug] [Thread-4 (]: Using postgres connection "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"
[0m18:19:24.154287 [debug] [Thread-2 (]: Began executing node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:19:24.154565 [debug] [Thread-1 (]: Finished running node test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb
[0m18:19:24.154730 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m18:19:24.154938 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        chv_id, report_month
    from "chw_analytics"."marts_metrics"."chw_activity_monthly"
    group by chv_id, report_month
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m18:19:24.157338 [debug] [Thread-2 (]: Writing runtime sql for node "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:19:24.157659 [debug] [Thread-3 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"
[0m18:19:24.157932 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select chv_id
from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where chv_id is null



  
  
      
    ) dbt_internal_test
[0m18:19:24.158256 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:19:24.158424 [debug] [Thread-2 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: BEGIN
[0m18:19:24.158587 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:19:24.158789 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:19:24.158965 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:19:24.159817 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: ROLLBACK
[0m18:19:24.160453 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: ROLLBACK
[0m18:19:24.160806 [debug] [Thread-4 (]: On test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48: Close
[0m18:19:24.160979 [debug] [Thread-3 (]: On test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa: Close
[0m18:19:24.161324 [info ] [Thread-4 (]: 7 of 9 PASS dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month  [[32mPASS[0m in 0.04s]
[0m18:19:24.161637 [info ] [Thread-3 (]: 8 of 9 PASS not_null_chw_activity_monthly_chv_id ............................... [[32mPASS[0m in 0.03s]
[0m18:19:24.161937 [debug] [Thread-4 (]: Finished running node test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48
[0m18:19:24.162198 [debug] [Thread-3 (]: Finished running node test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa
[0m18:19:24.165598 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m18:19:24.165813 [debug] [Thread-2 (]: Using postgres connection "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"
[0m18:19:24.165993 [debug] [Thread-2 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select report_month
from "chw_analytics"."marts_metrics"."chw_activity_monthly"
where report_month is null



  
  
      
    ) dbt_internal_test
[0m18:19:24.166740 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:19:24.167436 [debug] [Thread-2 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: ROLLBACK
[0m18:19:24.167731 [debug] [Thread-2 (]: On test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4: Close
[0m18:19:24.168038 [info ] [Thread-2 (]: 9 of 9 PASS not_null_chw_activity_monthly_report_month ......................... [[32mPASS[0m in 0.02s]
[0m18:19:24.168314 [debug] [Thread-2 (]: Finished running node test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4
[0m18:19:24.168935 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:24.169087 [debug] [MainThread]: On master: BEGIN
[0m18:19:24.169217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:24.178976 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m18:19:24.179206 [debug] [MainThread]: On master: COMMIT
[0m18:19:24.179347 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:24.179473 [debug] [MainThread]: On master: COMMIT
[0m18:19:24.179709 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:24.179841 [debug] [MainThread]: On master: Close
[0m18:19:24.180040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:24.180173 [debug] [MainThread]: Connection 'test.chw_analytics.dbt_utils_expression_is_true_chw_activity_monthly_unique_patients_served___0.d61e60f8bb' was properly closed.
[0m18:19:24.180298 [debug] [MainThread]: Connection 'test.chw_analytics.not_null_chw_activity_monthly_report_month.8ed7d888a4' was properly closed.
[0m18:19:24.180418 [debug] [MainThread]: Connection 'test.chw_analytics.not_null_chw_activity_monthly_chv_id.f1fc78fbaa' was properly closed.
[0m18:19:24.180535 [debug] [MainThread]: Connection 'test.chw_analytics.dbt_utils_unique_combination_of_columns_chw_activity_monthly_chv_id__report_month.12136adb48' was properly closed.
[0m18:19:24.180707 [info ] [MainThread]: 
[0m18:19:24.180859 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m18:19:24.181553 [debug] [MainThread]: Command end result
[0m18:19:24.196328 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m18:19:24.197496 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m18:19:24.201120 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m18:19:24.201336 [info ] [MainThread]: 
[0m18:19:24.201533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:24.201692 [info ] [MainThread]: 
[0m18:19:24.201854 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m18:19:24.203545 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.63173056, "process_in_blocks": "0", "process_kernel_time": 0.188621, "process_mem_max_rss": "143376384", "process_out_blocks": "0", "process_user_time": 1.142169}
[0m18:19:24.203762 [debug] [MainThread]: Command `dbt test` succeeded at 18:19:24.203725 after 0.63 seconds
[0m18:19:24.203958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f3450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ed1110>]}
[0m18:19:24.204159 [debug] [MainThread]: Flushing usage events
[0m18:19:25.308163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:19:49.295091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d774e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7cee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7f3e10>]}


============================== 18:19:49.297979 | 52613fe4-8257-4635-9b86-5b7c778c497b ==============================
[0m18:19:49.297979 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:19:49.298334 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'empty': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'printer_width': '80', 'target_path': 'None', 'debug': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'log_path': '/Users/mzaza/Downloads/main_task/logs', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error': 'None', 'no_print': 'None', 'profiles_dir': '/Users/mzaza/Downloads/main_task', 'invocation_command': 'dbt run --select chw_activity_monthly', 'static_parser': 'True', 'introspect': 'True', 'use_colors': 'True', 'partial_parse': 'True'}
[0m18:19:49.383125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52613fe4-8257-4635-9b86-5b7c778c497b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dc77750>]}
[0m18:19:49.409408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52613fe4-8257-4635-9b86-5b7c778c497b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b4b1d0>]}
[0m18:19:49.410788 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:19:49.479151 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:19:49.553859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:49.554111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:49.575977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52613fe4-8257-4635-9b86-5b7c778c497b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e162510>]}
[0m18:19:49.618251 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m18:19:49.619552 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m18:19:49.629746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52613fe4-8257-4635-9b86-5b7c778c497b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbfc910>]}
[0m18:19:49.630023 [info ] [MainThread]: Found 2 models, 11 data tests, 1 source, 576 macros
[0m18:19:49.630204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52613fe4-8257-4635-9b86-5b7c778c497b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e09ff10>]}
[0m18:19:49.630963 [info ] [MainThread]: 
[0m18:19:49.631134 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:49.631271 [info ] [MainThread]: 
[0m18:19:49.631521 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:19:49.631953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics'
[0m18:19:49.685944 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics"
[0m18:19:49.686191 [debug] [ThreadPool]: On list_chw_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:19:49.686341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:49.714459 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.028 seconds
[0m18:19:49.715183 [debug] [ThreadPool]: On list_chw_analytics: Close
[0m18:19:49.715770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_chw_analytics, now list_chw_analytics_marts)
[0m18:19:49.716030 [debug] [ThreadPool]: Acquiring new postgres connection 'list_chw_analytics_marts_metrics'
[0m18:19:49.719039 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m18:19:49.720166 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m18:19:49.720326 [debug] [ThreadPool]: On list_chw_analytics_marts: BEGIN
[0m18:19:49.720495 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: BEGIN
[0m18:19:49.720684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:49.720836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:49.734302 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m18:19:49.734586 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m18:19:49.734762 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts_metrics"
[0m18:19:49.734939 [debug] [ThreadPool]: Using postgres connection "list_chw_analytics_marts"
[0m18:19:49.735134 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts_metrics"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_metrics'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_metrics'
  
[0m18:19:49.735339 [debug] [ThreadPool]: On list_chw_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "list_chw_analytics_marts"} */
select
      'chw_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'chw_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m18:19:49.741119 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m18:19:49.741294 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m18:19:49.742051 [debug] [ThreadPool]: On list_chw_analytics_marts: ROLLBACK
[0m18:19:49.742599 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: ROLLBACK
[0m18:19:49.743086 [debug] [ThreadPool]: On list_chw_analytics_marts: Close
[0m18:19:49.743243 [debug] [ThreadPool]: On list_chw_analytics_marts_metrics: Close
[0m18:19:49.746124 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:49.746331 [debug] [MainThread]: On master: BEGIN
[0m18:19:49.746469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:49.755913 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:19:49.756131 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:49.756331 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:19:49.761074 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m18:19:49.761715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52613fe4-8257-4635-9b86-5b7c778c497b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e6181d0>]}
[0m18:19:49.761990 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:49.762295 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:49.762437 [debug] [MainThread]: On master: BEGIN
[0m18:19:49.762797 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:19:49.762950 [debug] [MainThread]: On master: COMMIT
[0m18:19:49.763086 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:49.763217 [debug] [MainThread]: On master: COMMIT
[0m18:19:49.763483 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:49.763807 [debug] [MainThread]: On master: Close
[0m18:19:49.765441 [debug] [Thread-1 (]: Began running node model.chw_analytics.chw_activity_monthly
[0m18:19:49.765758 [info ] [Thread-1 (]: 1 of 1 START sql incremental model marts_metrics.chw_activity_monthly .......... [RUN]
[0m18:19:49.766015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_chw_analytics_marts, now model.chw_analytics.chw_activity_monthly)
[0m18:19:49.766207 [debug] [Thread-1 (]: Began compiling node model.chw_analytics.chw_activity_monthly
[0m18:19:49.773825 [debug] [Thread-1 (]: Writing injected SQL for node "model.chw_analytics.chw_activity_monthly"
[0m18:19:49.774395 [debug] [Thread-1 (]: Began executing node model.chw_analytics.chw_activity_monthly
[0m18:19:49.801585 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:49.802019 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

    
  
    

  create temporary table "chw_activity_monthly__dbt_tmp181949789780"
  
  
    as
  
  (
    /*
Model: chw_activity_monthly
Description: Monthly aggregation of CHW activities for dashboard performance metrics

TODO: Complete this dbt model to aggregate CHW activities by month

Instructions:
1. Add the dbt config block (materialization, unique_key, incremental_strategy)
2. Filter out invalid records (NULL chv_id, NULL activity_date, deleted records)
3. Use the month_assignment macro to calculate report_month
4. Aggregate metrics: total_activities, unique_households_visited, unique_patients_served, pregnancy_visits, child_assessments, family_planning_visits
5. GROUP BY chv_id and report_month
6. Add incremental logic 
*/

-- ============================================
-- dbt Configuration
-- ============================================



-- ============================================
-- Main Query
-- ============================================

with source_data as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        is_deleted,
        created_at,
        updated_at
    from "chw_analytics"."marts"."fct_chv_activity"

    where 1=1
        -- Filter out invalid records as per business requirements
        and chv_id is not null
        and activity_date is not null  
        and is_deleted = false


),

with_report_month as (

    select
        activity_id,
        chv_id,
        activity_date,
        activity_type,
        household_id,
        patient_id,
        -- Use the month_assignment macro to calculate report_month
        


    case 
        -- Activities on/after 26th go to next month
        when extract(day from activity_date) >= 26 then
            date_trunc('month', activity_date + interval '1 month')
        -- Activities before 26th stay in current month  
        else
            date_trunc('month', activity_date)
    end
    

 as report_month

    from source_data

),

aggregated as (

    select
        chv_id,
        report_month,
        -- Calculate all required metrics
        count(*) as total_activities,
        count(distinct household_id) as unique_households_visited,
        count(distinct patient_id) as unique_patients_served,
        count(case when activity_type = 'pregnancy_visit' then 1 end) as pregnancy_visits,
        count(case when activity_type = 'child_assessment' then 1 end) as child_assessments,
        count(case when activity_type = 'family_planning' then 1 end) as family_planning_visits

    from with_report_month
    group by chv_id, report_month

)

-- ============================================
-- Final Select with Incremental Logic
-- ============================================
select * from aggregated


    -- Only reprocess recent months where late-arriving data might appear
    -- This keeps the model performant while handling late data properly
    where report_month >= (
        select date_trunc('month', max(report_month) - interval '2 months')
        from "chw_analytics"."marts_metrics"."chw_activity_monthly"
    )

  );
  
  
[0m18:19:49.802299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:49.821372 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.019 seconds
[0m18:19:49.828222 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:49.828511 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: BEGIN
[0m18:19:49.829010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m18:19:49.829205 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:49.829383 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'chw_activity_monthly__dbt_tmp181949789780'
        
      order by ordinal_position

  
[0m18:19:49.841080 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.011 seconds
[0m18:19:49.844200 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:49.844473 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chw_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'chw_activity_monthly'
        
        and table_schema = 'marts_metrics'
        
      order by ordinal_position

  
[0m18:19:49.849671 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m18:19:49.853571 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:49.853814 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "chw_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'chw_activity_monthly'
        
        and table_schema = 'marts_metrics'
        
      order by ordinal_position

  
[0m18:19:49.857980 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.004 seconds
[0m18:19:49.863724 [debug] [Thread-1 (]: Writing runtime sql for node "model.chw_analytics.chw_activity_monthly"
[0m18:19:49.864225 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:49.864452 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "chw_analytics", "target_name": "dev", "node_id": "model.chw_analytics.chw_activity_monthly"} */

      
        delete from "chw_analytics"."marts_metrics"."chw_activity_monthly" as DBT_INTERNAL_DEST
        where (chv_id, report_month) in (
            select distinct chv_id, report_month
            from "chw_activity_monthly__dbt_tmp181949789780" as DBT_INTERNAL_SOURCE
        );

    

    insert into "chw_analytics"."marts_metrics"."chw_activity_monthly" ("chv_id", "report_month", "total_activities", "unique_households_visited", "unique_patients_served", "pregnancy_visits", "child_assessments", "family_planning_visits")
    (
        select "chv_id", "report_month", "total_activities", "unique_households_visited", "unique_patients_served", "pregnancy_visits", "child_assessments", "family_planning_visits"
        from "chw_activity_monthly__dbt_tmp181949789780"
    )
  
[0m18:19:49.866127 [debug] [Thread-1 (]: SQL status: INSERT 0 6 in 0.001 seconds
[0m18:19:49.872653 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: COMMIT
[0m18:19:49.872864 [debug] [Thread-1 (]: Using postgres connection "model.chw_analytics.chw_activity_monthly"
[0m18:19:49.873029 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: COMMIT
[0m18:19:49.874195 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:19:49.875035 [debug] [Thread-1 (]: On model.chw_analytics.chw_activity_monthly: Close
[0m18:19:49.876017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52613fe4-8257-4635-9b86-5b7c778c497b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e685f50>]}
[0m18:19:49.876343 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model marts_metrics.chw_activity_monthly ..... [[32mINSERT 0 6[0m in 0.11s]
[0m18:19:49.876612 [debug] [Thread-1 (]: Finished running node model.chw_analytics.chw_activity_monthly
[0m18:19:49.877224 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:49.877381 [debug] [MainThread]: On master: BEGIN
[0m18:19:49.877510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:49.889779 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m18:19:49.889984 [debug] [MainThread]: On master: COMMIT
[0m18:19:49.890117 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:49.890246 [debug] [MainThread]: On master: COMMIT
[0m18:19:49.890499 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:19:49.890630 [debug] [MainThread]: On master: Close
[0m18:19:49.890812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:49.890936 [debug] [MainThread]: Connection 'model.chw_analytics.chw_activity_monthly' was properly closed.
[0m18:19:49.891051 [debug] [MainThread]: Connection 'list_chw_analytics_marts_metrics' was properly closed.
[0m18:19:49.891189 [info ] [MainThread]: 
[0m18:19:49.891332 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m18:19:49.891630 [debug] [MainThread]: Command end result
[0m18:19:49.905533 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/mzaza/Downloads/main_task/target/manifest.json
[0m18:19:49.906487 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/mzaza/Downloads/main_task/target/semantic_manifest.json
[0m18:19:49.909212 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/mzaza/Downloads/main_task/target/run_results.json
[0m18:19:49.909375 [info ] [MainThread]: 
[0m18:19:49.909579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:49.909730 [info ] [MainThread]: 
[0m18:19:49.909889 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:19:49.912242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6540772, "process_in_blocks": "0", "process_kernel_time": 0.218638, "process_mem_max_rss": "142901248", "process_out_blocks": "0", "process_user_time": 1.123693}
[0m18:19:49.912469 [debug] [MainThread]: Command `dbt run` succeeded at 18:19:49.912431 after 0.65 seconds
[0m18:19:49.912661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e39090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e39110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bdc5910>]}
[0m18:19:49.912833 [debug] [MainThread]: Flushing usage events
[0m18:19:51.112241 [debug] [MainThread]: An error was encountered while trying to flush usage events
